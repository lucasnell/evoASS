(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     92211,       2368]
NotebookOptionsPosition[     84444,       2227]
NotebookOutlinePosition[     84828,       2244]
CellTagsIndexPosition[     84785,       2241]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Figuring out \[PartialD]Vi/\[PartialD]Vi", "Title",
 CellChangeTimes->{{3.753621953502688*^9, 
  3.7536219782118807`*^9}},ExpressionUUID->"c042e951-2025-4e0d-a13e-\
d8ca27e3d7e8"],

Cell[TextData[{
 "This document creates an equation for the partial derivative of the traits \
in species ",
 StyleBox["i", "InlineFormula"],
 " at time ",
 StyleBox["t+1", "InlineFormula"],
 " with respect to the traits in species ",
 StyleBox["i", "InlineFormula"],
 " at time ",
 StyleBox["t", "InlineFormula"],
 "."
}], "Text",
 CellChangeTimes->{{3.753629562584296*^9, 
  3.753629624926436*^9}},ExpressionUUID->"ae16c92a-0774-471a-8af0-\
3b0e4aaad753"],

Cell[CellGroupData[{

Cell["\<\
Below is a configuration of traits and abundances for testing:\
\>", "Section",
 CellChangeTimes->{{3.753621996997225*^9, 3.753622016515552*^9}, {
  3.75362206195925*^9, 
  3.753622082062344*^9}},ExpressionUUID->"868342de-2436-4aa4-857d-\
7aa946265dae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zVi", "=", 
   RowBox[{"{", 
    RowBox[{
    "3.23531713336706", ",", "1.02777096442878", ",", "0.2787772170268"}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zVnei", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "5.27526782592759", ",", "1.44656382501125", ",", "0.14410174684599"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "9.97409204719588", ",", "1.06037032557651", ",", "2.78145811287686"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "5.59907909948379", ",", "2.24725058535114", ",", "1.8701455486007"}], 
      "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zNi", "=", "9.4145709397"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zNnei", "=", 
   RowBox[{"{", 
    RowBox[{
    "7.34398103217961", ",", "19.0046921810612", ",", "10.0717215593192"}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zf", "=", "0.2484041452"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zg", "=", "0.1476385485"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zCC", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "0.0450021495231871"}], ",", 
       RowBox[{"-", "0.0450021495231871"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.0450021495231871"}], ",", "1", ",", 
       RowBox[{"-", "0.0450021495231871"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.0450021495231871"}], ",", 
       RowBox[{"-", "0.0450021495231871"}], ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"zr0", "=", "0.4257492712"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zd", "=", 
   RowBox[{"-", "0.0917747103"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zn", " ", "=", " ", 
   RowBox[{
    RowBox[{"Length", "[", "zVnei", "]"}], " ", "+", " ", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zsigma2", " ", "=", " ", "0.1"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "These", " ", "are", " ", "used", " ", "as", " ", "intermediate", " ", 
    "objects", " ", "for", " ", "some", " ", 
    RowBox[{"functions", ":"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zCCC", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{"zCC", "+", 
     RowBox[{"Transpose", "[", "zCC", "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zZ", " ", "=", " ", 
   RowBox[{"zNi", "+", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", "j", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "zn"}]], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "zd"}], " ", 
        RowBox[{
         TemplateBox[{"zVnei","j"},
          "IndexedDefault"], ".", 
         TemplateBox[{"zVnei","j"},
          "IndexedDefault"]}]}]], " ", 
      TemplateBox[{"zNnei","j"},
       "IndexedDefault"]}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.7534707787792387`*^9, {3.753532220060666*^9, 3.753532225586433*^9}, {
   3.753532278245026*^9, 3.7535322934185877`*^9}, {3.753532332857998*^9, 
   3.7535323357837343`*^9}, {3.7535392892868433`*^9, 
   3.7535393235246887`*^9}, {3.753539531243889*^9, 3.753539563556134*^9}, {
   3.753539995913252*^9, 3.753540043445725*^9}, {3.753544895127701*^9, 
   3.753544898925906*^9}, {3.753554348177174*^9, 3.753554348917347*^9}, {
   3.7536220911544647`*^9, 3.753622115296742*^9}, {3.75362233477721*^9, 
   3.753622375192778*^9}},
 CellLabel->
  "In[1355]:=",ExpressionUUID->"6d415337-a530-41ed-bc1c-a5d46566b929"],

Cell[CellGroupData[{

Cell["Function to compute new trait values based on old ones:", "Subsection",
 CellChangeTimes->{{3.7536221252804203`*^9, 
  3.753622140368226*^9}},ExpressionUUID->"53dfe3da-9e82-4d9d-89b5-\
12556600d176"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"newV", "[", 
   RowBox[{
   "Vi_", ",", "Vnei_", ",", "Ni_", ",", "Nnei_", ",", "f_", ",", "g_", ",", 
    "CCC_", ",", "r0_", ",", "d_", ",", "n_", ",", "sigma2_"}], "]"}], ":=", 
  " ", 
  RowBox[{"Vi", " ", "+", " ", 
   RowBox[{"sigma2", " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", " ", "f"}], " ", "*", " ", 
       RowBox[{"Vi", ".", "CCC"}]}], " ", "+", " ", "\[IndentingNewLine]", 
      RowBox[{"2", " ", "*", " ", "g", " ", "*", " ", "Vi", " ", "*", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", " ", 
         RowBox[{"Vi", ".", "Vi"}]}], "]"}], "*", " ", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{"Ni", " ", "+", "\[IndentingNewLine]", "\t", 
         RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Indexed", "[", 
             RowBox[{"Nnei", ",", " ", "j"}], "]"}], " ", "*", " ", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "d"}], " ", "*", " ", 
              RowBox[{
               RowBox[{"Indexed", "[", 
                RowBox[{"Vnei", ",", " ", "j"}], "]"}], ".", 
               RowBox[{"Indexed", "[", 
                RowBox[{"Vnei", ",", " ", "j"}], "]"}]}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", 
             RowBox[{"n", "-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "\t", 
          "]"}]}], "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"newV", "[", 
  RowBox[{
  "zVi", ",", "zVnei", ",", "zNi", ",", "zNnei", ",", "zf", ",", "zg", ",", 
   "zCCC", ",", "zr0", ",", "zd", ",", "zn", ",", "zsigma2"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.753467665679366*^9, 3.753467703262856*^9}, {
   3.753468282304371*^9, 3.753468283790452*^9}, {3.7534683444590073`*^9, 
   3.753468408108335*^9}, {3.753468445882926*^9, 3.753468457109605*^9}, {
   3.7534684887017803`*^9, 3.753468490453557*^9}, {3.753470115587672*^9, 
   3.753470134644947*^9}, {3.753470282583737*^9, 3.753470285334467*^9}, {
   3.753473607819213*^9, 3.753473633797286*^9}, {3.753476070507077*^9, 
   3.753476077380375*^9}, {3.753532015318739*^9, 3.753532015542959*^9}, {
   3.753532123552998*^9, 3.753532144918846*^9}, {3.75353223303855*^9, 
   3.753532239339325*^9}, 3.753532324721878*^9, {3.753622156203539*^9, 
   3.753622156915612*^9}, 3.753622414557334*^9},
 CellLabel->
  "In[1368]:=",ExpressionUUID->"d7d1b27a-4531-49f2-b2d3-830f534f5dcf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3.4238114063104574`", ",", "1.0945790533464972`", ",", 
   "0.3042986537046338`"}], "}"}]], "Output",
 CellChangeTimes->{{3.753532240658567*^9, 3.753532247034665*^9}, 
   3.753532305476376*^9, 3.753532340163163*^9, 3.753559815819024*^9, 
   3.753560233719158*^9, 3.753561266339294*^9, 3.753614357627685*^9, 
   3.75362215797191*^9, 3.753622418741514*^9, 3.753622486493389*^9, 
   3.753624591444552*^9},
 CellLabel->
  "Out[1369]=",ExpressionUUID->"dda998fb-7857-4573-aaa5-d4d607747173"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
And doing the same thing but using an expression that\[CloseCurlyQuote]s been \
simplified to use `Z` instead of the big summation section:\
\>", "Subsection",
 CellChangeTimes->{{3.7536221700718412`*^9, 
  3.753622206922472*^9}},ExpressionUUID->"fe885080-7d1f-4fea-bbb3-\
4cb47d06127c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"newVexpr", ":=", " ", 
  RowBox[{"Vi", " ", "+", " ", 
   RowBox[{"sigma2", " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", " ", "f"}], " ", "*", " ", 
       RowBox[{"Vi", ".", "CCC"}]}], " ", "+", " ", "\[IndentingNewLine]", 
      RowBox[{"2", " ", "*", " ", "g", " ", "*", " ", "Vi", " ", "*", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", " ", 
         RowBox[{"Vi", ".", "Vi"}]}], "]"}], "*", " ", "Z"}]}], 
     "\[IndentingNewLine]", ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"newVexpr", " ", "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Vi", "\[Rule]", "zVi"}], ",", 
    RowBox[{"f", "\[Rule]", "zf"}], ",", 
    RowBox[{"g", "\[Rule]", "zg"}], ",", 
    RowBox[{"CCC", "\[Rule]", "zCCC"}], ",", " ", 
    RowBox[{"sigma2", " ", "\[Rule]", " ", "zsigma2"}], ",", " ", 
    RowBox[{"Z", " ", "\[Rule]", " ", "zZ"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.753468525973777*^9, 3.7534685269409027`*^9}, {
   3.753468559180668*^9, 3.753468587546713*^9}, 3.7534708028257113`*^9, {
   3.753473615031022*^9, 3.753473626109358*^9}, {3.753622211946175*^9, 
   3.753622300949449*^9}},
 CellLabel->
  "In[1370]:=",ExpressionUUID->"3299df55-5edf-4774-8cbc-292e6791ec7e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3.4238114063104574`", ",", "1.0945790533464972`", ",", 
   "0.3042986537046338`"}], "}"}]], "Output",
 CellChangeTimes->{{3.753468560317178*^9, 3.753468588353516*^9}, 
   3.753470804008355*^9, 3.75347366883926*^9, 3.753614362845499*^9, 
   3.753622302830366*^9, 3.753622506167308*^9, 3.753624594153646*^9},
 CellLabel->
  "Out[1371]=",ExpressionUUID->"0ee4b1da-1df7-4f60-af48-9b8a4e102afa"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Differentiating", "Section",
 CellChangeTimes->{{3.753622543261148*^9, 
  3.753622551451661*^9}},ExpressionUUID->"6217f40e-3b58-4ee0-8b0c-\
953fa58c683c"],

Cell[CellGroupData[{

Cell["\<\
We can see below that we now have the same problem as before (creating \
\[PartialD]F/\[PartialD]Vi) where Mathematica doesn\[CloseCurlyQuote]t handle \
matrices well:\
\>", "Subsection",
 CellChangeTimes->{{3.753622554072131*^9, 
  3.7536225831415997`*^9}},ExpressionUUID->"0d85e9db-9fcb-48ea-a96a-\
dab77d2f3371"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"D", "[", 
  RowBox[{"newVexpr", ",", " ", 
   RowBox[{"{", "Vi", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"newVexpr", ",", " ", 
    RowBox[{"{", "Vi", "}"}]}], "]"}], "  ", "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Vi", "\[Rule]", "zVi"}], ",", 
    RowBox[{"f", "\[Rule]", "zf"}], ",", 
    RowBox[{"g", "\[Rule]", "zg"}], ",", 
    RowBox[{"CCC", "\[Rule]", "zCCC"}], ",", " ", 
    RowBox[{"sigma2", " ", "\[Rule]", " ", "zsigma2"}], ",", " ", 
    RowBox[{"Z", " ", "\[Rule]", " ", "zZ"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.753468617933073*^9, 3.753468618508765*^9}, {
   3.753470142620495*^9, 3.753470149361575*^9}, {3.753470617446679*^9, 
   3.7534706631512547`*^9}, 3.753470810537166*^9, 3.7534750280212603`*^9, {
   3.753622515809346*^9, 3.75362253517714*^9}, {3.7536246116678457`*^9, 
   3.753624611772007*^9}, {3.7537094069664383`*^9, 3.753709407082515*^9}, 
   3.753709451103107*^9},
 CellLabel->
  "In[1374]:=",ExpressionUUID->"699596c0-f35f-44d6-8426-255bd5dfbcf1"],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{"sigma2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        RowBox[{"Vi", ".", "Vi"}]}]], " ", "g", " ", "Z"}], "-", 
     RowBox[{"f", " ", 
      RowBox[{"1", ".", "CCC"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        RowBox[{"Vi", ".", "Vi"}]}]], " ", "g", " ", "Vi", " ", "Z", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"1", ".", "Vi"}]}], "-", 
        RowBox[{"Vi", ".", "1"}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7534686194582577`*^9, {3.753470150280596*^9, 3.753470159273312*^9}, 
   3.753470290851741*^9, 3.7534706390989847`*^9, 3.753470677738769*^9, 
   3.753470812378223*^9, 3.7534736741018353`*^9, 3.753475030454228*^9, 
   3.753561270189127*^9, 3.7536143637553988`*^9, {3.753622518890815*^9, 
   3.7536225360288277`*^9}, {3.753624578244327*^9, 3.7536246141275997`*^9}},
 CellLabel->
  "Out[1374]=",ExpressionUUID->"f78801ae-7a25-4888-9088-7ad1b5b557e9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1", "+", 
    RowBox[{"0.1`", " ", 
     RowBox[{"(", 
      RowBox[{"1.0703939943964147`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2484041452`", " ", 
        RowBox[{"1", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "0.0900042990463742`"}], ",", 
             RowBox[{"-", "0.0900042990463742`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.0900042990463742`"}], ",", "2", ",", 
             RowBox[{"-", "0.0900042990463742`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.0900042990463742`"}], ",", 
             RowBox[{"-", "0.0900042990463742`"}], ",", "2"}], "}"}]}], 
          "}"}]}]}], "+", 
       RowBox[{"3.4630640295239252`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"1", ".", 
            RowBox[{"{", 
             RowBox[{
             "3.23531713336706`", ",", "1.02777096442878`", ",", 
              "0.2787772170268`"}], "}"}]}]}], "-", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "3.23531713336706`", ",", "1.02777096442878`", ",", 
             "0.2787772170268`"}], "}"}], ".", "1"}]}], ")"}]}]}], ")"}]}]}], 
   ",", 
   RowBox[{"1", "+", 
    RowBox[{"0.1`", " ", 
     RowBox[{"(", 
      RowBox[{"1.0703939943964147`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2484041452`", " ", 
        RowBox[{"1", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "0.0900042990463742`"}], ",", 
             RowBox[{"-", "0.0900042990463742`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.0900042990463742`"}], ",", "2", ",", 
             RowBox[{"-", "0.0900042990463742`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.0900042990463742`"}], ",", 
             RowBox[{"-", "0.0900042990463742`"}], ",", "2"}], "}"}]}], 
          "}"}]}]}], "+", 
       RowBox[{"1.1001198679395774`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"1", ".", 
            RowBox[{"{", 
             RowBox[{
             "3.23531713336706`", ",", "1.02777096442878`", ",", 
              "0.2787772170268`"}], "}"}]}]}], "-", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "3.23531713336706`", ",", "1.02777096442878`", ",", 
             "0.2787772170268`"}], "}"}], ".", "1"}]}], ")"}]}]}], ")"}]}]}], 
   ",", 
   RowBox[{"1", "+", 
    RowBox[{"0.1`", " ", 
     RowBox[{"(", 
      RowBox[{"1.0703939943964147`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2484041452`", " ", 
        RowBox[{"1", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "0.0900042990463742`"}], ",", 
             RowBox[{"-", "0.0900042990463742`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.0900042990463742`"}], ",", "2", ",", 
             RowBox[{"-", "0.0900042990463742`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.0900042990463742`"}], ",", 
             RowBox[{"-", "0.0900042990463742`"}], ",", "2"}], "}"}]}], 
          "}"}]}]}], "+", 
       RowBox[{"0.2984014588800326`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"1", ".", 
            RowBox[{"{", 
             RowBox[{
             "3.23531713336706`", ",", "1.02777096442878`", ",", 
              "0.2787772170268`"}], "}"}]}]}], "-", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "3.23531713336706`", ",", "1.02777096442878`", ",", 
             "0.2787772170268`"}], "}"}], ".", "1"}]}], ")"}]}]}], 
      ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7534686194582577`*^9, {3.753470150280596*^9, 3.753470159273312*^9}, 
   3.753470290851741*^9, 3.7534706390989847`*^9, 3.753470677738769*^9, 
   3.753470812378223*^9, 3.7534736741018353`*^9, 3.753475030454228*^9, 
   3.753561270189127*^9, 3.7536143637553988`*^9, {3.753622518890815*^9, 
   3.7536225360288277`*^9}, {3.753624578244327*^9, 3.753624614141691*^9}},
 CellLabel->
  "Out[1375]=",ExpressionUUID->"ec2aef90-5ed1-4909-a628-5254aa0e053c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions for calculating \[PartialD]Vi/\[PartialD]Vi", "Subsection",
 CellChangeTimes->{{3.753622949287766*^9, 3.753622953711961*^9}, {
  3.753622990675169*^9, 
  3.753622999170176*^9}},ExpressionUUID->"60d10940-e287-44ab-b4a3-\
95c6295897e4"],

Cell["\<\
The first version below removes all `.1` and `1.`, which makes the output the \
proper size. However, the off-diagonal answers are incorrect (you\
\[CloseCurlyQuote]ll see this below).

The second version\[LongDash]the correct one\[LongDash]includes identity \
matrices instead of two of the `1`s because that\[CloseCurlyQuote]s the \
derivative of `\[PartialD]x/\[PartialD]x` where `x` is a vector. It is also \
more careful about using matrix multiplication in the latter part of the \
equation.\
\>", "Text",
 CellChangeTimes->{{3.753622871837695*^9, 3.753622927927806*^9}, {
  3.753622962673038*^9, 3.753623049283152*^9}, {3.753623221336199*^9, 
  3.753623281810583*^9}, {3.75362337491722*^9, 3.753623433030675*^9}, {
  3.753623486504509*^9, 
  3.753623537713963*^9}},ExpressionUUID->"b6586912-140d-4b99-9e4c-\
36a0e130d910"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"DVfunNaive", "[", 
   RowBox[{
   "Vi_", ",", "Z_", ",", "f_", ",", "g_", ",", "CCC_", ",", "sigma2_"}], 
   "]"}], ":=", " ", 
  RowBox[{"1", "+", 
   RowBox[{"sigma2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         RowBox[{"Vi", ".", "Vi"}]}]], " ", "g", " ", "Z", " ", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"Vi", " ", 
          RowBox[{"(", 
           RowBox[{"Vi", "+", "Vi"}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{"f", " ", "CCC"}]}], " ", ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DVfun", "[", 
    RowBox[{
    "Vi_", ",", "Z_", ",", "f_", ",", "g_", ",", "CCC_", ",", "sigma2_"}], 
    "]"}], ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "DV", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eye", " ", "=", " ", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"Length", "[", "CCC", "]"}], "]"}]}], ";", " ", 
      RowBox[{"DV", " ", "=", " ", 
       RowBox[{"eye", " ", "+", " ", 
        RowBox[{"sigma2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              RowBox[{"Vi", ".", "Vi"}]}]], " ", "g", " ", "Z", 
            RowBox[{"(", 
             RowBox[{"eye", " ", "-", 
              RowBox[{"2", " ", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", "Vi", "}"}], "]"}], ".", 
                RowBox[{"{", "Vi", "}"}]}]}]}], ")"}]}], "-", 
           RowBox[{"f", " ", "CCC"}]}], ")"}]}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DVfunNaive", "[", 
  RowBox[{
  "zVi", ",", "zZ", ",", "zf", ",", "zg", ",", "zCCC", ",", "zsigma2"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DVfun", "[", 
  RowBox[{
  "zVi", ",", "zZ", ",", "zf", ",", "zg", ",", "zCCC", ",", "zsigma2"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.753470680913138*^9, 3.75347072500154*^9}, {
   3.7534736875609503`*^9, 3.7534736930619383`*^9}, 3.753474964754184*^9, {
   3.753475093222301*^9, 3.753475095548539*^9}, 3.7535367900594673`*^9, {
   3.753537829712243*^9, 3.753537830231577*^9}, {3.753539375321241*^9, 
   3.7535394836008797`*^9}, {3.7535396550178328`*^9, 3.753539675415572*^9}, {
   3.753540026715948*^9, 3.753540027341935*^9}, {3.753540078534655*^9, 
   3.7535400791637373`*^9}, {3.753540333251877*^9, 3.753540341619169*^9}, {
   3.753544420660448*^9, 3.753544600360833*^9}, {3.753545829439685*^9, 
   3.7535459643683167`*^9}, {3.753546002732243*^9, 3.753546010848969*^9}, {
   3.753546044517206*^9, 3.75354618602325*^9}, {3.753558357982336*^9, 
   3.753558382048934*^9}, 3.7536226339803133`*^9, {3.753622732700247*^9, 
   3.753622778845482*^9}, {3.753622821407482*^9, 3.753622861519663*^9}, {
   3.7536230651101007`*^9, 3.753623135201255*^9}, 3.7536231985141277`*^9, {
   3.75362332233425*^9, 3.753623401686488*^9}, {3.7536234561366987`*^9, 
   3.75362345625659*^9}, {3.75362351513822*^9, 3.753623519930475*^9}},
 CellLabel->
  "In[1376]:=",ExpressionUUID->"25156734-1818-4b08-913c-3b65022a70b6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.1834635073335433`"}], ",", 
     RowBox[{"-", "1.1315469341966495`"}], ",", 
     RowBox[{"-", "1.1315469341966495`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.8831408920046311`", ",", "0.8312243188677372`", ",", 
     "0.8831408920046311`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.092637637883873`", ",", "1.092637637883873`", ",", 
     "1.040721064746979`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.75362286333047*^9, 3.7536231394444237`*^9, {3.75362316948913*^9, 
   3.753623199241157*^9}, 3.753623355629013*^9, 3.753623521049404*^9, 
   3.753624617213626*^9},
 CellLabel->
  "Out[1378]=",ExpressionUUID->"3921c784-9444-4042-8f74-732ec6471bbb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.1834635073335433`"}], ",", 
     RowBox[{"-", "0.7096115874035904`"}], ",", 
     RowBox[{"-", "0.1908489264103652`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7096115874035904`"}], ",", "0.8312243188677372`", ",", 
     RowBox[{"-", "0.059101926939123244`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.1908489264103652`"}], ",", 
     RowBox[{"-", "0.059101926939123244`"}], ",", "1.040721064746979`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.75362286333047*^9, 3.7536231394444237`*^9, {3.75362316948913*^9, 
   3.753623199241157*^9}, 3.753623355629013*^9, 3.753623521049404*^9, 
   3.7536246172264347`*^9},
 CellLabel->
  "Out[1379]=",ExpressionUUID->"21eb13ca-2820-4411-8b86-1b31bdfc0187"]
}, Open  ]],

Cell["\<\
Below we can see that the second version provides correct results in this \
case.\
\>", "Text",
 CellChangeTimes->{{3.753623543700839*^9, 
  3.753623566210644*^9}},ExpressionUUID->"2f1abac1-df19-44a2-8b08-\
f265a214a944"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<NumericalCalculus`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ND", "[", 
    RowBox[{
     RowBox[{"newV", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z", ",", " ", 
         RowBox[{"zVi", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
         RowBox[{"zVi", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "zVnei", ",", "zNi", 
       ",", "zNnei", ",", "zf", ",", "zg", ",", "zCCC", ",", "zr0", ",", "zd",
        ",", "zn", ",", "zsigma2"}], "]"}], ",", " ", "z", ",", " ", 
     RowBox[{"zVi", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ND", "[", 
    RowBox[{
     RowBox[{"newV", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"zVi", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "z", ",", " ", 
         RowBox[{"zVi", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "zVnei", ",", "zNi", 
       ",", "zNnei", ",", "zf", ",", "zg", ",", "zCCC", ",", "zr0", ",", "zd",
        ",", "zn", ",", "zsigma2"}], "]"}], ",", " ", "z", ",", " ", 
     RowBox[{"zVi", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ND", "[", 
    RowBox[{
     RowBox[{"newV", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"zVi", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{"zVi", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", "z"}], "}"}], ",", 
       "zVnei", ",", "zNi", ",", "zNnei", ",", "zf", ",", "zg", ",", "zCCC", 
       ",", "zr0", ",", "zd", ",", "zn", ",", "zsigma2"}], "]"}], ",", " ", 
     "z", ",", " ", 
     RowBox[{"zVi", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.753532476153983*^9, 3.753532537475811*^9}, 
   3.753532574591056*^9, {3.753532625704853*^9, 3.753532625854834*^9}, {
   3.75353395824998*^9, 3.7535339718574142`*^9}, {3.75353728013857*^9, 
   3.753537305193055*^9}, {3.7536231851776752`*^9, 3.753623189519691*^9}},
 CellLabel->
  "In[1380]:=",ExpressionUUID->"390d024b-782a-439d-9347-b7e19b6e7d56"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.1834631900562513`"}], ",", 
     RowBox[{"-", "0.7096113293001255`"}], ",", 
     RowBox[{"-", "0.19084885640121052`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7096115847881657`"}], ",", "0.8312243143233423`", ",", 
     RowBox[{"-", "0.05910192671376201`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.19084892907325263`"}], ",", 
     RowBox[{"-", "0.059101927785047`"}], ",", "1.0407210679823744`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.753532575706464*^9, 3.753534082010645*^9, 3.7535373103282146`*^9, {
   3.753558398141595*^9, 3.753558421692449*^9}, {3.753560252114353*^9, 
   3.75356025661087*^9}, 3.753561276377121*^9, 3.753614368524611*^9, {
   3.75362317807524*^9, 3.753623190003331*^9}, 3.753624628827031*^9},
 CellLabel->
  "Out[1381]=",ExpressionUUID->"e04d905f-2b34-4247-99a4-8b4f35e2ee46"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing analytical solution", "Section",
 CellChangeTimes->{{3.753623575501313*^9, 
  3.753623584628776*^9}},ExpressionUUID->"ebcdff8f-062f-4cc4-a19e-\
e543db114129"],

Cell[CellGroupData[{

Cell["\<\
Below looks for proportional differences between the numerical \
differentiation and the analytical one by using both on simulated datasets :\
\>", "Subsection",
 CellChangeTimes->{{3.7536246481260443`*^9, 3.753624668972138*^9}, {
  3.7536250170056477`*^9, 
  3.753625021741941*^9}},ExpressionUUID->"2359ab65-b9e6-4d6d-ab67-\
67324da640d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getDiff", "[", 
    RowBox[{
    "V_", ",", " ", "N_", ",", " ", "d_", ",", "f_", ",", " ", "g_", ",", " ",
      "r0_", ",", " ", "CCC_", ",", " ", "sigma2_", ",", " ", "i_"}], "]"}], 
   " ", ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ZZ", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Length", "[", "N", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q", " ", "=", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"V", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Vi", " ", "=", " ", 
       RowBox[{"V", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ni", " ", "=", " ", 
       RowBox[{"N", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Vnei", " ", "=", " ", 
       RowBox[{"Drop", "[", 
        RowBox[{"V", ",", " ", 
         RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Nnei", " ", "=", " ", 
       RowBox[{"Drop", "[", 
        RowBox[{"N", ",", " ", 
         RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Z", " ", "=", " ", 
       RowBox[{"Ni", "+", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", "j", 
          RowBox[{"n", "-", "1"}]], 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "d"}], " ", 
            RowBox[{
             TemplateBox[{"Vnei","j"},
              "IndexedDefault"], ".", 
             TemplateBox[{"Vnei","j"},
              "IndexedDefault"]}]}]], " ", 
          TemplateBox[{"Nnei","j"},
           "IndexedDefault"]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"XX", " ", "=", " ", 
       RowBox[{"DVfun", "[", 
        RowBox[{
        "Vi", ",", "Z", ",", "f", ",", "g", ",", "CCC", ",", "sigma2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"YY", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ND", "[", 
          RowBox[{
           RowBox[{"newV", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", " ", 
               RowBox[{"Vi", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
               RowBox[{"Vi", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "Vnei", ",", 
             "Ni", ",", "Nnei", ",", "f", ",", "g", ",", "CCC", ",", "r0", 
             ",", "d", ",", "n", ",", "sigma2"}], "]"}], ",", " ", "x", ",", 
           " ", 
           RowBox[{"Vi", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ND", "[", 
          RowBox[{
           RowBox[{"newV", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Vi", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", "x", ",", " ", 
               RowBox[{"Vi", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "Vnei", ",", 
             "Ni", ",", "Nnei", ",", "f", ",", "g", ",", "CCC", ",", "r0", 
             ",", "d", ",", "n", ",", "sigma2"}], "]"}], ",", " ", "x", ",", 
           " ", 
           RowBox[{"Vi", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ND", "[", 
          RowBox[{
           RowBox[{"newV", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Vi", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"Vi", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", " ", "x"}], "}"}], ",", 
             "Vnei", ",", "Ni", ",", "Nnei", ",", "f", ",", "g", ",", "CCC", 
             ",", "r0", ",", "d", ",", "n", ",", "sigma2"}], "]"}], ",", " ", 
           "x", ",", " ", 
           RowBox[{"Vi", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ZZ", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"XX", " ", "-", " ", "YY"}], ")"}], " ", "/", " ", "XX"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ZZ", " ", "=", " ", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"ZZ", ",", 
         RowBox[{"{", 
          RowBox[{"q", "^", "2"}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"testEquations", " ", "[", 
     RowBox[{"n_", ",", " ", "q_", ",", " ", "sigma2_", ",", "seed_"}], "]"}],
     " ", ":=", " ", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "Z", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SeedRandom", "[", "seed", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"xV", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomVariate", "[", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", 
             RowBox[{"0", ",", "5"}], "]"}], ",", "q"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xN", " ", "=", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"RandomVariate", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{
             RowBox[{"Log", "[", "10", "]"}], ",", "0.5"}], "]"}], ",", "n"}],
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xf", "=", " ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"RandomVariate", "[", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", 
             RowBox[{
              RowBox[{"Log", "[", "0.2", "]"}], ",", "0.5"}], "]"}], ",", 
            "1"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xg", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"RandomVariate", "[", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", 
             RowBox[{
              RowBox[{"Log", "[", "0.1", "]"}], ",", "0.5"}], "]"}], ",", 
            "1"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xeta", " ", "=", " ", 
        RowBox[{
         RowBox[{"RandomVariate", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0", ",", "0.1"}], "]"}], ",", "1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xCC", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"xeta", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "q"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "q"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xCC", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"i", ",", "q"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"xCCC", " ", "=", " ", 
        RowBox[{"xCC", " ", "+", " ", 
         RowBox[{"Transpose", "[", "xCC", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xr0", " ", "=", " ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"RandomVariate", "[", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", 
             RowBox[{
              RowBox[{"Log", "[", "0.25", "]"}], ",", "0.25"}], "]"}], ",", 
            "1"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xd", " ", "=", " ", 
        RowBox[{
         RowBox[{"RandomVariate", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0", ",", "0.2"}], "]"}], ",", "1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Z", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"getDiff", "[", 
           RowBox[{
           "xV", ",", " ", "xN", ",", " ", "xd", ",", "xf", ",", " ", "xg", 
            ",", " ", "xr0", ",", " ", "xCCC", ",", " ", "sigma2", ",", " ", 
            "i"}], "]"}], " ", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Z", " ", "=", " ", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{"Z", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"q", "^", "2"}], " ", "*", " ", "n"}], "}"}]}], 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SeedRandom", "[", "87952437980", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seeds", " ", "=", " ", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "2147483647"}], "}"}], ",", " ", "100"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diffs", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"testEquations", " ", "[", 
      RowBox[{"4", ",", " ", "3", ",", " ", "0.01", ",", " ", 
       RowBox[{"seeds", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", 
       RowBox[{"Length", "[", "seeds", "]"}]}], "}"}]}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7535557775552607`*^9, 3.75355579624693*^9}, {
   3.7535558870730553`*^9, 3.753555904883295*^9}, {3.7535559635807962`*^9, 
   3.753555990496271*^9}, {3.7535560750897818`*^9, 3.7535561239386883`*^9}, {
   3.753556231888427*^9, 3.753556465412878*^9}, {3.753556608082852*^9, 
   3.753556716123979*^9}, {3.7535569261060057`*^9, 3.753556933544394*^9}, {
   3.753557134393361*^9, 3.753557253979814*^9}, {3.7535577755910892`*^9, 
   3.753557792982876*^9}, {3.753557905151349*^9, 3.753558022557045*^9}, {
   3.753558059339355*^9, 3.753558114147971*^9}, {3.75355818599435*^9, 
   3.753558338067667*^9}, {3.753558433478759*^9, 3.75355843872611*^9}, {
   3.7535584749862547`*^9, 3.753558632850466*^9}, {3.753558679731045*^9, 
   3.753558861241457*^9}, {3.7535589455613813`*^9, 3.7535589483830557`*^9}, {
   3.753558999810691*^9, 3.7535590064497538`*^9}, {3.753559051875423*^9, 
   3.75355909236582*^9}, {3.753559160585453*^9, 3.7535592134922047`*^9}, {
   3.75355951056069*^9, 3.753559542451565*^9}, {3.7535595881074057`*^9, 
   3.753559603328833*^9}, {3.753559724459794*^9, 3.753559758562867*^9}, {
   3.753559929654458*^9, 3.753560026908969*^9}, {3.753560191884768*^9, 
   3.75356019215711*^9}, {3.75356070426927*^9, 3.753560765939643*^9}, 
   3.753560802508079*^9, {3.7535612937241173`*^9, 3.7535612939220877`*^9}, {
   3.753561329264661*^9, 3.753561332069323*^9}, {3.753561366959524*^9, 
   3.75356137028611*^9}, {3.7535614067907743`*^9, 3.753561425465485*^9}, 
   3.7535614615951757`*^9, 3.753561571482342*^9, {3.7535616428575363`*^9, 
   3.753561817608741*^9}, {3.753561879116119*^9, 3.753562057193532*^9}, {
   3.753562097953726*^9, 3.7535621954741507`*^9}, {3.753614419826215*^9, 
   3.753614426961391*^9}, {3.7536144623348217`*^9, 3.753614515178419*^9}, {
   3.753614568221199*^9, 3.75361462340944*^9}, {3.753614653808782*^9, 
   3.753614689433194*^9}, {3.7536147719551992`*^9, 3.753614781346582*^9}, {
   3.7536148398681803`*^9, 3.753614842786941*^9}, {3.75361493303193*^9, 
   3.7536149908241262`*^9}, {3.7536176929454613`*^9, 3.753617698207612*^9}},
 CellLabel->
  "In[1382]:=",ExpressionUUID->"fe626473-581a-4c4e-801e-b17e1a62e241"],

Cell[CellGroupData[{

Cell["\<\
We can see that some are pretty different, although most are pretty much \
exactly the same:\
\>", "Subsubsection",
 CellChangeTimes->{{3.7536246817239017`*^9, 
  3.753624700996044*^9}},ExpressionUUID->"1e91ab72-9bc5-428c-b2f9-\
244bd651dbed"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Min", "[", "diffs", "]"}], ",", " ", 
    RowBox[{"Max", "[", "diffs", "]"}]}], "}"}], " ", "//", " ", 
  "Print"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Quantile", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", "diffs", "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"0.025", ",", " ", "0.975"}], "}"}]}], "]"}], " ", "//", " ", 
  "Print"}]}], "Input",
 CellChangeTimes->{{3.75356029133908*^9, 3.7535604452606583`*^9}, {
   3.753561344445315*^9, 3.753561347778501*^9}, {3.753614587819528*^9, 
   3.7536145896019907`*^9}, {3.753614793091234*^9, 3.75361480785693*^9}, 
   3.753614902416923*^9, {3.7536149950988293`*^9, 3.753614999558807*^9}, {
   3.753617734935409*^9, 3.75361775818277*^9}, {3.753624743140873*^9, 
   3.753624776422763*^9}, {3.7536248319384613`*^9, 3.7536248326303053`*^9}, {
   3.753624869442438*^9, 3.753624981028966*^9}},
 CellLabel->
  "In[1425]:=",ExpressionUUID->"2a83efd4-2c6b-4c46-9a52-c54117c8e28b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.7126342828073994`"}], ",", "0.0019412092651835229`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.753624977536976*^9, 3.753624981500124*^9}},
 CellLabel->
  "During evaluation of \
In[1425]:=",ExpressionUUID->"53c023a8-9e58-4c15-8f0b-ff88e79d3c05"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "5.636151041988244`*^-8"}], ",", "1.3754389067389616`*^-7"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.753624977536976*^9, 3.75362498151748*^9}},
 CellLabel->
  "During evaluation of \
In[1425]:=",ExpressionUUID->"e11cc0f0-b92b-46d0-be48-67096a2bc7e8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Now I'm going to look more closely at the instances where they differ:\
\>", "Subsection",
 CellChangeTimes->{{3.753624994892465*^9, 
  3.753625053990752*^9}},ExpressionUUID->"63eb2519-1366-4790-8bc4-\
fefa39375bdc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"thresh", " ", "=", " ", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Baddies", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"diffs", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "100"}], ",", " ", "i"}], "]"}], "]"}], ",", 
        " ", 
        RowBox[{
         RowBox[{
          RowBox[{"#", " ", ">", " ", "thresh"}], "||", " ", 
          RowBox[{"#", " ", "<", " ", 
           RowBox[{"-", "thresh"}]}]}], "&"}]}], "]"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", 
       RowBox[{
        RowBox[{"3", "^", "2"}], " ", "*", " ", "4"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7536150807227*^9, 3.7536151379069157`*^9}, {
   3.753615187628417*^9, 3.7536152838301077`*^9}, {3.753615322786725*^9, 
   3.753615352391966*^9}, 3.753615394820225*^9, {3.753616024108663*^9, 
   3.7536160582288303`*^9}, {3.753616216422134*^9, 3.7536162704593697`*^9}, {
   3.753616325336005*^9, 3.753616350591683*^9}, {3.753616491293291*^9, 
   3.753616540795966*^9}, {3.753616613992717*^9, 3.75361665289587*^9}, {
   3.75361671108971*^9, 3.7536167167293053`*^9}, {3.753617135764633*^9, 
   3.753617138259286*^9}, 3.753617405464306*^9, {3.753617724377646*^9, 
   3.7536177245347357`*^9}, {3.753617775296199*^9, 3.753617827642996*^9}, {
   3.7536178665961847`*^9, 3.753617927460227*^9}, {3.75361815418288*^9, 
   3.753618159179495*^9}, {3.7536182287456083`*^9, 3.7536182947387657`*^9}, {
   3.75361834002746*^9, 3.753618340312757*^9}, {3.753618658236271*^9, 
   3.753618696532131*^9}, {3.753618738372377*^9, 3.753618830000773*^9}, 
   3.753624992136814*^9, {3.753625066438675*^9, 3.753625236622178*^9}, 
   3.753625271842718*^9},
 CellLabel->
  "In[1500]:=",ExpressionUUID->"e211f600-7d52-41f2-b713-6e5c7a805505"],

Cell[TextData[StyleBox["How many times does a particular location in the \
output deviate significantly?",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{
  3.753625329599374*^9},ExpressionUUID->"8b7183f1-684d-4734-be9b-\
2d8a957fd35e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Max", "[", "Baddies", "]"}], " ", "//", " ", "Print"}]], "Input",
 CellChangeTimes->{{3.7536150807227*^9, 3.7536151379069157`*^9}, {
   3.753615187628417*^9, 3.7536152838301077`*^9}, {3.753615322786725*^9, 
   3.753615352391966*^9}, 3.753615394820225*^9, {3.753616024108663*^9, 
   3.7536160582288303`*^9}, {3.753616216422134*^9, 3.7536162704593697`*^9}, {
   3.753616325336005*^9, 3.753616350591683*^9}, {3.753616491293291*^9, 
   3.753616540795966*^9}, {3.753616613992717*^9, 3.75361665289587*^9}, {
   3.75361671108971*^9, 3.7536167167293053`*^9}, {3.753617135764633*^9, 
   3.753617138259286*^9}, 3.753617405464306*^9, {3.753617724377646*^9, 
   3.7536177245347357`*^9}, {3.753617775296199*^9, 3.753617827642996*^9}, {
   3.7536178665961847`*^9, 3.753617927460227*^9}, {3.75361815418288*^9, 
   3.753618159179495*^9}, {3.7536182287456083`*^9, 3.7536182947387657`*^9}, {
   3.75361834002746*^9, 3.753618340312757*^9}, {3.753618658236271*^9, 
   3.753618696532131*^9}, {3.753618738372377*^9, 3.753618830000773*^9}, 
   3.753624992136814*^9, {3.753625066438675*^9, 3.753625236622178*^9}, {
   3.753625271842718*^9, 3.7536252760003157`*^9}, {3.75362532684274*^9, 
   3.753625327728146*^9}},
 CellLabel->
  "In[1502]:=",ExpressionUUID->"4c1e60b1-837f-48ec-9075-0cfdb01b0c0b"],

Cell[BoxData["1"], "Print",
 CellChangeTimes->{3.753625398722937*^9},
 CellLabel->
  "During evaluation of \
In[1502]:=",ExpressionUUID->"df5cb8aa-8192-405c-b17d-6661b86d8859"]
}, Open  ]],

Cell[TextData[StyleBox["Positions where any diffs fail (is > `thresh` or < ` \
- thresh`):",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.753625318661079*^9, 
  3.753625321535755*^9}},ExpressionUUID->"bd8a66d3-4d05-4298-bcda-\
17b014542131"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"badInds", " ", "=", " ", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"diffs", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "100"}], ",", " ", "iii"}], "]"}], "]"}], 
           ",", " ", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#", " ", ">", " ", "thresh"}], " ", "||", " ", 
               RowBox[{"#", " ", "<", " ", 
                RowBox[{"-", "thresh"}]}]}], "&"}], ")"}]}]}], "]"}], "]"}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"iii", ",", " ", 
          RowBox[{
           RowBox[{"3", "^", "2"}], " ", "*", " ", "4"}]}], "}"}]}], "]"}], 
      "]"}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{"badInds", " ", "//", " ", "Print"}]}], "Input",
 CellChangeTimes->{{3.7536150807227*^9, 3.7536151379069157`*^9}, {
   3.753615187628417*^9, 3.7536152838301077`*^9}, {3.753615322786725*^9, 
   3.753615352391966*^9}, 3.753615394820225*^9, {3.753616024108663*^9, 
   3.7536160582288303`*^9}, {3.753616216422134*^9, 3.7536162704593697`*^9}, {
   3.753616325336005*^9, 3.753616350591683*^9}, {3.753616491293291*^9, 
   3.753616540795966*^9}, {3.753616613992717*^9, 3.75361665289587*^9}, {
   3.75361671108971*^9, 3.7536167167293053`*^9}, {3.753617135764633*^9, 
   3.753617138259286*^9}, 3.753617405464306*^9, {3.753617724377646*^9, 
   3.7536177245347357`*^9}, {3.753617775296199*^9, 3.753617827642996*^9}, {
   3.7536178665961847`*^9, 3.753617927460227*^9}, {3.75361815418288*^9, 
   3.753618159179495*^9}, {3.7536182287456083`*^9, 3.7536182947387657`*^9}, {
   3.75361834002746*^9, 3.753618340312757*^9}, {3.753618658236271*^9, 
   3.753618696532131*^9}, {3.753618738372377*^9, 3.753618830000773*^9}, 
   3.753624992136814*^9, {3.753625066438675*^9, 3.753625236622178*^9}, {
   3.753625271842718*^9, 3.753625282449082*^9}, {3.7536253155706778`*^9, 
   3.753625316512344*^9}},
 CellLabel->
  "In[1503]:=",ExpressionUUID->"b3b01c37-0fa8-4b94-af89-97a800034aba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"20", ",", "44", ",", "53", ",", "91"}], "}"}]], "Print",
 CellChangeTimes->{3.753625400078511*^9},
 CellLabel->
  "During evaluation of \
In[1503]:=",ExpressionUUID->"213c5985-219e-4849-bd38-45eb85625e21"]
}, Open  ]],

Cell[TextData[StyleBox["When they differ, how much do they differ by?",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.753625308287342*^9, 
  3.7536253106632767`*^9}},ExpressionUUID->"8cf098b4-7bbc-47d6-bb41-\
abea4e8e0747"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"diffs", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", " ", ">", " ", "thresh"}], "||", " ", 
        RowBox[{"#", " ", "<", " ", 
         RowBox[{"-", "thresh"}]}]}], "&"}]}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "badInds"}], "}"}]}], "]"}], " ", "//", " ", 
  "Print"}]], "Input",
 CellChangeTimes->{{3.7536150807227*^9, 3.7536151379069157`*^9}, {
   3.753615187628417*^9, 3.7536152838301077`*^9}, {3.753615322786725*^9, 
   3.753615352391966*^9}, 3.753615394820225*^9, {3.753616024108663*^9, 
   3.7536160582288303`*^9}, {3.753616216422134*^9, 3.7536162704593697`*^9}, {
   3.753616325336005*^9, 3.753616350591683*^9}, {3.753616491293291*^9, 
   3.753616540795966*^9}, {3.753616613992717*^9, 3.75361665289587*^9}, {
   3.75361671108971*^9, 3.7536167167293053`*^9}, {3.753617135764633*^9, 
   3.753617138259286*^9}, 3.753617405464306*^9, {3.753617724377646*^9, 
   3.7536177245347357`*^9}, {3.753617775296199*^9, 3.753617827642996*^9}, {
   3.7536178665961847`*^9, 3.753617927460227*^9}, {3.75361815418288*^9, 
   3.753618159179495*^9}, {3.7536182287456083`*^9, 3.7536182947387657`*^9}, {
   3.75361834002746*^9, 3.753618340312757*^9}, {3.753618658236271*^9, 
   3.753618696532131*^9}, {3.753618738372377*^9, 3.753618830000773*^9}, 
   3.753624992136814*^9, {3.753625066438675*^9, 3.753625236622178*^9}, {
   3.753625271842718*^9, 3.753625305009606*^9}},
 CellLabel->
  "In[1505]:=",ExpressionUUID->"a24f71fd-36a6-4df7-b694-095cdf0d2e11"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.055755951709794575`"}], ",", 
     RowBox[{"-", "0.04780964324545359`"}], ",", 
     RowBox[{"-", "0.055755951709792924`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7126311491497441`"}], ",", 
     RowBox[{"-", "0.6312638609632909`"}], ",", 
     RowBox[{"-", "0.7126342828073994`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.015013720536553738`"}], ",", 
     RowBox[{"-", "0.014978193498048858`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.2011240749096846`"}], ",", 
     RowBox[{"-", "0.20254684343483198`"}]}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.753625403029604*^9},
 CellLabel->
  "During evaluation of \
In[1505]:=",ExpressionUUID->"04ad0e27-2439-42b6-a43e-50d89865241e"]
}, Open  ]],

Cell[TextData[StyleBox["Positions in the output that differ. Do any positions \
appear regularly?",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{
  3.75362529796745*^9},ExpressionUUID->"8e9f9b9f-a4f4-4486-bc13-e44b805dac15"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"Position", "[", 
      RowBox[{
       RowBox[{"diffs", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", " ", ">", " ", "thresh"}], "||", " ", 
           RowBox[{"#", " ", "<", " ", 
            RowBox[{"-", "thresh"}]}]}], "&"}], ")"}]}]}], "]"}], "]"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "badInds"}], "}"}]}], "]"}], " ", "//", " ", 
  "Print"}]], "Input",
 CellChangeTimes->{{3.7536150807227*^9, 3.7536151379069157`*^9}, {
   3.753615187628417*^9, 3.7536152838301077`*^9}, {3.753615322786725*^9, 
   3.753615352391966*^9}, 3.753615394820225*^9, {3.753616024108663*^9, 
   3.7536160582288303`*^9}, {3.753616216422134*^9, 3.7536162704593697`*^9}, {
   3.753616325336005*^9, 3.753616350591683*^9}, {3.753616491293291*^9, 
   3.753616540795966*^9}, {3.753616613992717*^9, 3.75361665289587*^9}, {
   3.75361671108971*^9, 3.7536167167293053`*^9}, {3.753617135764633*^9, 
   3.753617138259286*^9}, 3.753617405464306*^9, {3.753617724377646*^9, 
   3.7536177245347357`*^9}, {3.753617775296199*^9, 3.753617827642996*^9}, {
   3.7536178665961847`*^9, 3.753617927460227*^9}, {3.75361815418288*^9, 
   3.753618159179495*^9}, {3.7536182287456083`*^9, 3.7536182947387657`*^9}, {
   3.75361834002746*^9, 3.753618340312757*^9}, {3.753618658236271*^9, 
   3.753618696532131*^9}, {3.753618738372377*^9, 3.753618830000773*^9}, 
   3.753624992136814*^9, {3.753625066438675*^9, 3.753625236622178*^9}, {
   3.753625271842718*^9, 3.7536252947675867`*^9}},
 CellLabel->
  "In[1506]:=",ExpressionUUID->"6d6aa3dc-5ca1-4ae5-af1b-97521231ef0b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"13", ",", "14", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"22", ",", "23", ",", "24"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"29", ",", "30"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"34", ",", "35"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.753625132883676*^9, 3.753625148551899*^9}, 
   3.753625198166395*^9, 3.7536252389039497`*^9, 3.7536254042672033`*^9},
 CellLabel->
  "During evaluation of \
In[1506]:=",ExpressionUUID->"9b026358-4514-4c32-ae56-faab65f99608"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Do analytical and numerical methods separately and compare to version in R:\
\>", "Subsection",
 CellChangeTimes->{{3.753625410921579*^9, 
  3.753625433900036*^9}},ExpressionUUID->"b33c9e2b-8e74-4190-bef9-\
ee1c47f3ff5b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"getAnalytical", "[", 
   RowBox[{
   "V_", ",", " ", "N_", ",", " ", "d_", ",", "f_", ",", " ", "g_", ",", " ", 
    "r0_", ",", " ", "CCC_", ",", " ", "sigma2_", ",", " ", "i_"}], "]"}], 
  " ", ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "XX", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "N", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"q", " ", "=", " ", 
      RowBox[{"Length", "[", 
       RowBox[{"V", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Vi", " ", "=", " ", 
      RowBox[{"V", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ni", " ", "=", " ", 
      RowBox[{"N", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Vnei", " ", "=", " ", 
      RowBox[{"Drop", "[", 
       RowBox[{"V", ",", " ", 
        RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Nnei", " ", "=", " ", 
      RowBox[{"Drop", "[", 
       RowBox[{"N", ",", " ", 
        RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Z", " ", "=", " ", 
      RowBox[{"Ni", "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", "j", 
         RowBox[{"n", "-", "1"}]], 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "d"}], " ", 
           RowBox[{
            TemplateBox[{"Vnei","j"},
             "IndexedDefault"], ".", 
            TemplateBox[{"Vnei","j"},
             "IndexedDefault"]}]}]], " ", 
         TemplateBox[{"Nnei","j"},
          "IndexedDefault"]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"XX", " ", "=", " ", 
      RowBox[{"DVfun", "[", 
       RowBox[{
       "Vi", ",", "Z", ",", "f", ",", "g", ",", "CCC", ",", "sigma2"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"XX", " ", "=", " ", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{"XX", ",", 
        RowBox[{"{", 
         RowBox[{"q", "^", "2"}], "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getNumeric", "[", 
   RowBox[{
   "V_", ",", " ", "N_", ",", " ", "d_", ",", "f_", ",", " ", "g_", ",", " ", 
    "r0_", ",", " ", "CCC_", ",", " ", "sigma2_", ",", " ", "i_"}], "]"}], 
  " ", ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "YY", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "N", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"q", " ", "=", " ", 
      RowBox[{"Length", "[", 
       RowBox[{"V", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Vi", " ", "=", " ", 
      RowBox[{"V", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ni", " ", "=", " ", 
      RowBox[{"N", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Vnei", " ", "=", " ", 
      RowBox[{"Drop", "[", 
       RowBox[{"V", ",", " ", 
        RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Nnei", " ", "=", " ", 
      RowBox[{"Drop", "[", 
       RowBox[{"N", ",", " ", 
        RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Z", " ", "=", " ", 
      RowBox[{"Ni", "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", "j", 
         RowBox[{"n", "-", "1"}]], 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "d"}], " ", 
           RowBox[{
            TemplateBox[{"Vnei","j"},
             "IndexedDefault"], ".", 
            TemplateBox[{"Vnei","j"},
             "IndexedDefault"]}]}]], " ", 
         TemplateBox[{"Nnei","j"},
          "IndexedDefault"]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"YY", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ND", "[", 
         RowBox[{
          RowBox[{"newV", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", " ", 
              RowBox[{"Vi", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
              RowBox[{"Vi", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "Vnei", ",", 
            "Ni", ",", "Nnei", ",", "f", ",", "g", ",", "CCC", ",", "r0", ",",
             "d", ",", "n", ",", "sigma2"}], "]"}], ",", " ", "x", ",", " ", 
          RowBox[{"Vi", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ND", "[", 
         RowBox[{
          RowBox[{"newV", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Vi", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", "x", ",", " ", 
              RowBox[{"Vi", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "Vnei", ",", 
            "Ni", ",", "Nnei", ",", "f", ",", "g", ",", "CCC", ",", "r0", ",",
             "d", ",", "n", ",", "sigma2"}], "]"}], ",", " ", "x", ",", " ", 
          RowBox[{"Vi", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ND", "[", 
         RowBox[{
          RowBox[{"newV", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Vi", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
              RowBox[{"Vi", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", " ", "x"}], "}"}], ",", 
            "Vnei", ",", "Ni", ",", "Nnei", ",", "f", ",", "g", ",", "CCC", 
            ",", "r0", ",", "d", ",", "n", ",", "sigma2"}], "]"}], ",", " ", 
          "x", ",", " ", 
          RowBox[{"Vi", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"YY", " ", "=", " ", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{"YY", ",", 
        RowBox[{"{", 
         RowBox[{"q", "^", "2"}], "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"badSeeds", " ", "=", " ", 
   RowBox[{"seeds", "[", 
    RowBox[{"[", "badInds", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7536160850543613`*^9, 3.753616203828081*^9}, {
   3.753616263660981*^9, 3.753616263773027*^9}, {3.7536167398445177`*^9, 
   3.753616976992943*^9}, {3.753617016035434*^9, 3.7536170933657303`*^9}, {
   3.7536171648399057`*^9, 3.753617235409231*^9}, {3.7536172697314177`*^9, 
   3.753617330963415*^9}, 3.753617494073276*^9, {3.7536176617522287`*^9, 
   3.75361766192505*^9}, {3.753618354915947*^9, 3.7536186113079033`*^9}, {
   3.75361885762728*^9, 3.753618913549172*^9}, {3.753618954518805*^9, 
   3.753619077871607*^9}, 3.753621111366115*^9, {3.7536215827386293`*^9, 
   3.753621594683914*^9}},
 CellLabel->
  "In[1147]:=",ExpressionUUID->"cfb38c37-0611-4cba-9cee-b8cece2e611c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xseed", " ", "=", " ", 
   RowBox[{"badSeeds", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xn", " ", "=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xq", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xsigma2", " ", "=", " ", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SeedRandom", "[", "xseed", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xV", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "5"}], "]"}], ",", "xq"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"iii", ",", " ", "xn"}], "}"}]}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xN", " ", "=", " ", 
   RowBox[{"Exp", "[", 
    RowBox[{"RandomVariate", "[", 
     RowBox[{
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"Log", "[", "10", "]"}], ",", "0.5"}], "]"}], ",", "xn"}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xf", "=", " ", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         RowBox[{"Log", "[", "0.2", "]"}], ",", "0.5"}], "]"}], ",", "1"}], 
      "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xg", "=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         RowBox[{"Log", "[", "0.1", "]"}], ",", "0.5"}], "]"}], ",", "1"}], 
      "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xeta", " ", "=", " ", 
   RowBox[{
    RowBox[{"RandomVariate", "[", 
     RowBox[{
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"0", ",", "0.1"}], "]"}], ",", "1"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xCC", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"xeta", ",", " ", 
     RowBox[{"{", 
      RowBox[{"iii", ",", " ", "xq"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"iii", ",", " ", "xq"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xCC", "[", 
      RowBox[{"[", 
       RowBox[{"iii", ",", "iii"}], "]"}], "]"}], " ", "=", " ", "1"}], ",", 
    RowBox[{"{", 
     RowBox[{"iii", ",", "xq"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xCCC", " ", "=", " ", 
   RowBox[{"xCC", " ", "+", " ", 
    RowBox[{"Transpose", "[", "xCC", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xr0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         RowBox[{"Log", "[", "0.25", "]"}], ",", "0.25"}], "]"}], ",", "1"}], 
      "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xd", " ", "=", " ", 
    RowBox[{
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "0.2"}], "]"}], ",", "1"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"getAnalytical", "[", 
      RowBox[{
      "xV", ",", " ", "xN", ",", " ", "xd", ",", "xf", ",", " ", "xg", ",", 
       " ", "xr0", ",", " ", "xCCC", ",", " ", "xsigma2", ",", " ", "i"}], 
      "]"}], " ", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "xn"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", " ", "=", " ", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{"X", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xq", "^", "2"}], " ", "*", " ", "xn"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"getNumeric", "[", 
      RowBox[{
      "xV", ",", " ", "xN", ",", " ", "xd", ",", "xf", ",", " ", "xg", ",", 
       " ", "xr0", ",", " ", "xCCC", ",", " ", "xsigma2", ",", " ", "i"}], 
      "]"}], " ", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "xn"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Y", " ", "=", " ", 
    RowBox[{"ArrayReshape", "[", 
     RowBox[{"Y", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xq", "^", "2"}], " ", "*", " ", "xn"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"X", " ", "-", " ", "Y"}], ")"}], " ", "/", " ", "X"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"bi", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Position", "[", 
    RowBox[{"Z", ",", " ", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", " ", ">", " ", "thresh"}], "||", " ", 
         RowBox[{"#", " ", "<", " ", 
          RowBox[{"-", "thresh"}]}]}], "&"}], ")"}]}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7536160850543613`*^9, 3.753616203828081*^9}, {
   3.753616263660981*^9, 3.753616263773027*^9}, {3.7536167398445177`*^9, 
   3.753616976992943*^9}, {3.753617016035434*^9, 3.7536170933657303`*^9}, {
   3.7536171648399057`*^9, 3.753617235409231*^9}, {3.7536172697314177`*^9, 
   3.753617330963415*^9}, 3.753617494073276*^9, {3.7536176617522287`*^9, 
   3.75361766192505*^9}, {3.753618354915947*^9, 3.7536186113079033`*^9}, {
   3.75361885762728*^9, 3.753618913549172*^9}, {3.753618954518805*^9, 
   3.753619077871607*^9}, 3.753621111366115*^9, {3.7536215827386293`*^9, 
   3.753621599449698*^9}, {3.753621774249928*^9, 3.753621774382779*^9}},
 CellLabel->
  "In[1182]:=",ExpressionUUID->"a168c3a2-34ee-4fff-a7b2-3f115eda9aba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"34", ",", "35"}], "}"}]], "Output",
 CellChangeTimes->{3.753619053542239*^9, 3.753619086322638*^9, 
  3.753621112492467*^9, 3.7536216000164547`*^9, 3.7536217760681667`*^9},
 CellLabel->
  "Out[1202]=",ExpressionUUID->"2541c3b3-1df5-4a5c-aa60-585e939136a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"X", "\[IndentingNewLine]", "Y"}], "Input",
 CellChangeTimes->{{3.753619114525667*^9, 3.7536191164305687`*^9}},
 CellLabel->
  "In[1203]:=",ExpressionUUID->"19a4609c-e92d-4a47-b488-5db34220dff1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.9984432158054616`", ",", 
   RowBox[{"-", "0.000059751213855963047`"}], ",", 
   RowBox[{"-", "0.00005975121385828942`"}], ",", 
   RowBox[{"-", "0.000059751213855963047`"}], ",", "0.9984432158054621`", ",", 
   RowBox[{"-", "0.00005975121385543086`"}], ",", 
   RowBox[{"-", "0.00005975121385828942`"}], ",", 
   RowBox[{"-", "0.00005975121385543086`"}], ",", "0.9984432158054594`", ",", 
   "0.9984432158054625`", ",", 
   RowBox[{"-", "0.00005975121385657207`"}], ",", 
   RowBox[{"-", "0.00005975121385657207`"}], ",", 
   RowBox[{"-", "0.00005975121385657207`"}], ",", "0.9984432158054625`", ",", 
   
   RowBox[{"-", "0.00005975121385657207`"}], ",", 
   RowBox[{"-", "0.00005975121385657207`"}], ",", 
   RowBox[{"-", "0.00005975121385657207`"}], ",", "0.9984432158054625`", ",", 
   
   RowBox[{"-", "2.0596388514650824`*^11"}], ",", 
   RowBox[{"-", "3.885582164662273`*^10"}], ",", "1.1795703900874295`*^11", 
   ",", 
   RowBox[{"-", "3.885582164662273`*^10"}], ",", 
   RowBox[{"-", "3.7618502328066754`*^9"}], ",", "2.1886642523563526`*^10", 
   ",", "1.1795703900874295`*^11", ",", "2.1886642523563526`*^10", ",", 
   RowBox[{"-", "6.299489129641544`*^10"}], ",", "0.9970705466096388`", ",", 
   RowBox[{"-", "0.0010571040284931285`"}], ",", "0.0039867446402190665`", 
   ",", 
   RowBox[{"-", "0.0010571040284931285`"}], ",", "0.9978562640183177`", ",", 
   "0.002695432922655303`", ",", "0.0039867446402190665`", ",", 
   "0.002695432922655303`", ",", "0.9873569105226027`"}], "}"}]], "Output",
 CellChangeTimes->{3.753619116856154*^9, 3.753621117010651*^9, 
  3.753621604157207*^9, 3.753621791150264*^9},
 CellLabel->
  "Out[1203]=",ExpressionUUID->"40ced5f1-76a9-4afd-9181-c1ab1fd8c32f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.9984432158055628`", ",", 
   RowBox[{"-", "0.00005975121385404347`"}], ",", 
   RowBox[{"-", "0.00005975121404732323`"}], ",", 
   RowBox[{"-", "0.000059751213950959465`"}], ",", "0.9984432158054101`", ",", 
   RowBox[{"-", "0.00005975121404939047`"}], ",", 
   RowBox[{"-", "0.00005975121395137945`"}], ",", 
   RowBox[{"-", "0.000059751213853097`"}], ",", "0.9984432158054476`", ",", 
   "0.9984432158052572`", ",", 
   RowBox[{"-", "0.00005975121394992793`"}], ",", 
   RowBox[{"-", "0.00005975121385252849`"}], ",", 
   RowBox[{"-", "0.00005975121366178069`"}], ",", "0.9984432158053692`", ",", 
   
   RowBox[{"-", "0.00005975121385252849`"}], ",", 
   RowBox[{"-", "0.00005975121366178069`"}], ",", 
   RowBox[{"-", "0.00005975121394992793`"}], ",", "0.9984432158056756`", ",", 
   
   RowBox[{"-", "2.0622996571454578`*^11"}], ",", 
   RowBox[{"-", "3.891981235833451`*^10"}], ",", "1.1815129959976111`*^11", 
   ",", 
   RowBox[{"-", "3.885582093225577`*^10"}], ",", 
   RowBox[{"-", "3.7618501497345424`*^9"}], ",", "2.1886642121176174`*^10", 
   ",", "1.1795701374705977`*^11", ",", "2.188663783631933`*^10", ",", 
   RowBox[{"-", "6.299488804669086`*^10"}], ",", "0.9970705465447843`", ",", 
   RowBox[{"-", "0.0010571040004972703`"}], ",", "0.003986744526606115`", ",", 
   RowBox[{"-", "0.0010571040388408024`"}], ",", "0.9978562640265646`", ",", 
   "0.0026954329510616624`", ",", "0.0047885749678842696`", ",", 
   "0.0032413843528294583`", ",", "0.9854402441398532`"}], "}"}]], "Output",
 CellChangeTimes->{3.753619116856154*^9, 3.753621117010651*^9, 
  3.753621604157207*^9, 3.753621791167611*^9},
 CellLabel->
  "Out[1204]=",ExpressionUUID->"27391c08-6485-4810-8cc6-ab1f7a4600bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"X", "[", 
  RowBox[{"[", "bi", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Y", "[", 
  RowBox[{"[", "bi", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.753617507872014*^9, 3.753617509998849*^9}, {
  3.753618899274807*^9, 3.753618899912746*^9}, {3.753619065622815*^9, 
  3.7536191120065937`*^9}},
 CellLabel->
  "In[1205]:=",ExpressionUUID->"0e114663-b35c-4bc8-a471-6132a7d381b5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0039867446402190665`", ",", "0.002695432922655303`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.753617510513*^9, 3.753617668095715*^9, 3.7536188678037643`*^9, {
   3.753618900620693*^9, 3.753618903737637*^9}, 3.75361908820677*^9, 
   3.753621123963743*^9, 3.7536216133775253`*^9, 3.75362179256677*^9},
 CellLabel->
  "Out[1205]=",ExpressionUUID->"2de0a362-ca19-4d7b-996a-283dd83d2af5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0047885749678842696`", ",", "0.0032413843528294583`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.753617510513*^9, 3.753617668095715*^9, 3.7536188678037643`*^9, {
   3.753618900620693*^9, 3.753618903737637*^9}, 3.75361908820677*^9, 
   3.753621123963743*^9, 3.7536216133775253`*^9, 3.753621792582426*^9},
 CellLabel->
  "Out[1206]=",ExpressionUUID->"c7e48c21-faf8-4c1e-9a96-c8f80f45585c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Print", "[", 
  RowBox[{"InputForm", "[", "xV", "]"}], "]"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"InputForm", "[", "xN", "]"}], "]"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"InputForm", "[", "xf", "]"}], "]"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"InputForm", "[", "xg", "]"}], "]"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"InputForm", "[", "xeta", "]"}], "]"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"InputForm", "[", "xr0", "]"}], "]"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"InputForm", "[", "xd", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.75361837781605*^9, 3.75361838065875*^9}, {
   3.753618476861897*^9, 3.753618477093885*^9}, {3.7536186134436398`*^9, 
   3.753618615545162*^9}, {3.753618885402096*^9, 3.7536188875207243`*^9}, {
   3.753618972498152*^9, 3.7536189730162077`*^9}, {3.753619212483302*^9, 
   3.7536192142411137`*^9}, 3.753619290307447*^9, 3.753619416874152*^9, {
   3.753619514957755*^9, 3.7536195628039513`*^9}, {3.753619593064156*^9, 
   3.753619699176291*^9}, 3.7536197384598227`*^9, {3.75362113094978*^9, 
   3.7536211324587183`*^9}},
 CellLabel->
  "In[1207]:=",ExpressionUUID->"bb74e544-090e-485b-aafe-3679224ccf75"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4.523568172322234"}], ",", " ", "3.005974865105819", ",",
        " ", 
       RowBox[{"-", "8.476476603643343"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "8.348389902684094", ",", " ", "5.533506282005329", ",", " ", 
       "8.448226532378758"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "5.510833905823022"}], ",", " ", 
       RowBox[{"-", "1.022521866580105"}], ",", " ", "3.1041333471316737"}], 
      "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"2.819548100862004", ",", " ", "1.9197781190861363", ",", " ", 
       RowBox[{"-", "7.788993108179111"}]}], "}"}]}], "}"}],
   ShowStringCharacters->True,
   NumberMarks->True],
  InputForm[{{-4.523568172322234, 3.005974865105819, -8.476476603643343}, {
   8.348389902684094, 5.533506282005329, 
   8.448226532378758}, {-5.510833905823022, -1.022521866580105, 
   3.1041333471316737`}, {2.819548100862004, 
   1.9197781190861363`, -7.788993108179111}}],
  AutoDelete->True,
  Editable->True]], "Print",
 CellChangeTimes->{3.753619739088134*^9, 3.753621132954611*^9, 
  3.753621618377871*^9, 3.753621796387285*^9},
 CellLabel->
  "During evaluation of \
In[1207]:=",ExpressionUUID->"28d8bb33-507d-4456-8b6b-e5c826f6dab5"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   RowBox[{"{", 
    RowBox[{
    "8.80432080243994", ",", " ", "13.038389993010794", ",", " ", 
     "9.5702348534691", ",", " ", "7.014089072922491"}], "}"}],
   ShowStringCharacters->True,
   NumberMarks->True],
  InputForm[{8.80432080243994, 13.038389993010794`, 9.5702348534691, 
   7.014089072922491}],
  AutoDelete->True,
  Editable->True]], "Print",
 CellChangeTimes->{3.753619739088134*^9, 3.753621132954611*^9, 
  3.753621618377871*^9, 3.7536217964003267`*^9},
 CellLabel->
  "During evaluation of \
In[1207]:=",ExpressionUUID->"e683eadd-4616-4e56-a989-c8f1810c8dc8"],

Cell[BoxData[
 InterpretationBox[
  StyleBox["0.07783920972687426",
   ShowStringCharacters->True,
   NumberMarks->True],
  InputForm[0.07783920972687426],
  AutoDelete->True,
  Editable->True]], "Print",
 CellChangeTimes->{3.753619739088134*^9, 3.753621132954611*^9, 
  3.753621618377871*^9, 3.7536217964138193`*^9},
 CellLabel->
  "During evaluation of \
In[1207]:=",ExpressionUUID->"72d584ab-c3c8-40a0-81fe-7b6712b6795c"],

Cell[BoxData[
 InterpretationBox[
  StyleBox["0.04763935790986568",
   ShowStringCharacters->True,
   NumberMarks->True],
  InputForm[0.04763935790986568],
  AutoDelete->True,
  Editable->True]], "Print",
 CellChangeTimes->{3.753619739088134*^9, 3.753621132954611*^9, 
  3.753621618377871*^9, 3.753621796423058*^9},
 CellLabel->
  "During evaluation of \
In[1207]:=",ExpressionUUID->"903ee868-88a9-47c4-a5cd-52acf6f20b00"],

Cell[BoxData[
 InterpretationBox[
  StyleBox["0.03838117965626182",
   ShowStringCharacters->True,
   NumberMarks->True],
  InputForm[0.03838117965626182],
  AutoDelete->True,
  Editable->True]], "Print",
 CellChangeTimes->{3.753619739088134*^9, 3.753621132954611*^9, 
  3.753621618377871*^9, 3.753621796432138*^9},
 CellLabel->
  "During evaluation of \
In[1207]:=",ExpressionUUID->"7d3348cf-c25d-4eb8-ad12-f64eab1aa663"],

Cell[BoxData[
 InterpretationBox[
  StyleBox["0.1705618918650814",
   ShowStringCharacters->True,
   NumberMarks->True],
  InputForm[0.1705618918650814],
  AutoDelete->True,
  Editable->True]], "Print",
 CellChangeTimes->{3.753619739088134*^9, 3.753621132954611*^9, 
  3.753621618377871*^9, 3.753621796441094*^9},
 CellLabel->
  "During evaluation of \
In[1207]:=",ExpressionUUID->"188755b9-34f6-46bb-a703-6624535d644a"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   RowBox[{"-", "0.39257116733513214"}],
   ShowStringCharacters->True,
   NumberMarks->True],
  InputForm[-0.39257116733513214`],
  AutoDelete->True,
  Editable->True]], "Print",
 CellChangeTimes->{3.753619739088134*^9, 3.753621132954611*^9, 
  3.753621618377871*^9, 3.753621796450674*^9},
 CellLabel->
  "During evaluation of \
In[1207]:=",ExpressionUUID->"7c45d65e-8f06-438b-b9a3-5ce56d5cfb5a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["R code:", "Subsection",
 CellChangeTimes->{{3.753625615416552*^9, 
  3.7536256194263487`*^9}},ExpressionUUID->"9f79e394-880a-4937-9647-\
5014d93432f3"],

Cell["\<\

one_analytical <- function(i, N, V, f, g, CCC, d, sigma2) {
    n <- length(N)
    q <- ncol(V)
    eye <- diag(q)
    Z = N[i] + sum(sapply(1:n,
                          function(j) {
                              if (j == i) return(0)
                              exp(-d * V[j,,drop=F] %*% t(V[j,,drop=F])) * N[j]
                          }))
    Vi <- V[i,,drop=FALSE]

    an_deriv <- eye + sigma2 * { 2 * g * Z * exp(- Vi %*% t(Vi))[[1]] *
            (eye + -2 * t(Vi) %*% Vi) - f * CCC }

    return(as.numeric(an_deriv))
}
one_numeric <- function(i, N, V, f, g, CCC, d, sigma2) {
    n <- length(N)
    q <- ncol(V)
    eye <- diag(q)
    Z = N[i] + sum(sapply(1:n,
                          function(j) {
                              if (j == i) return(0)
                              exp(-d * V[j,,drop=F] %*% t(V[j,,drop=F])) * N[j]
                          }))
    Vi <- V[i,,drop=FALSE]

    foo <- function(x) {
        Vi_ <- rbind(x)
        V_hat <- Vi_ + sigma2 * (-f * Vi %*% CCC + 2 * g * Z * Vi_ *
                                     exp(- Vi_ %*% t(Vi_))[[1]])
        return(as.numeric(V_hat))
    }
    num_deriv <- numDeriv::jacobian(foo, x = Vi)

    return(as.numeric(num_deriv))
}

# Although hardly elegant, I pasted the output from Mathematica here to \
create these objects:
xV = rbind(c(-4.523568172322234, 3.005974865105819, -8.476476603643343), \
c(8.348389902684094, 5.533506282005329, 8.448226532378758), \
c(-5.510833905823022, -1.022521866580105, 3.1041333471316737), \
c(2.819548100862004, 1.9197781190861363, -7.788993108179111))
xN = c(8.80432080243994, 13.038389993010794, 9.5702348534691, \
7.014089072922491)
xf = 0.07783920972687426
xg = 0.04763935790986568
xeta = 0.03838117965626182
xr0 = 0.1705618918650814
xd = -0.39257116733513214
xCCC = matrix(xeta, 3, 3); diag(xCCC) = 1; xCCC = xCCC + t(xCCC)
xsigma2 = 0.01

bi <- 34:35

ans <- do.call(c, lapply(1:length(xN), one_analytical, N = xN, V = xV, f = \
xf, g = xg,
                         CCC = xCCC, d = xd, sigma2 = xsigma2))
nums <- do.call(c, lapply(1:length(xN), one_numeric, N = xN, V = xV, f = xf, \
g = xg,
                          CCC = xCCC, d = xd, sigma2 = xsigma2))
ans[bi]
nums[bi]
\
\>", "Program",
 CellEvaluationLanguage->"NodeJS",
 CellChangeTimes->{{3.753622451713464*^9, 3.75362247726845*^9}, {
   3.753625455573613*^9, 3.7536254601446743`*^9}, 3.753625542153462*^9, {
   3.753625845522407*^9, 
   3.753625888346843*^9}},ExpressionUUID->"e7a51438-ae0e-4bc9-b9fd-\
6678b618ad62"],

Cell["\<\
R\[CloseCurlyQuote]s numerical solutions agree with the analytical solutions \
from above when it diverges from Mathematica\[CloseCurlyQuote]s numerical \
solution. Thus the analytical one seems correct.\
\>", "Subsubsection",
 CellChangeTimes->{{3.753625900902812*^9, 
  3.753626008381692*^9}},ExpressionUUID->"f1f1733f-dee4-4371-9aa7-\
9f877478d1ef"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final equation for the derivative:", "Section",
 CellChangeTimes->{{3.75362441418723*^9, 
  3.753624431435987*^9}},ExpressionUUID->"23196bf9-2fd6-4f94-8fd4-\
6a7a9e20801f"],

Cell[BoxData[{
 RowBox[{
  FractionBox[
   RowBox[{"\[PartialD]", 
    SubscriptBox[
     StyleBox["V",
      FontWeight->"Bold"], 
     StyleBox["i",
      FontWeight->"Bold"]]}], 
   RowBox[{"\[PartialD]", 
    StyleBox[
     SubscriptBox["V", "i"],
     FontWeight->"Bold"]}]], "=", 
  RowBox[{
   StyleBox["I",
    FontWeight->"Bold"], " ", "+", " ", 
   RowBox[{
    SuperscriptBox["\[Sigma]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          StyleBox[
           SubscriptBox["V", "i"],
           FontWeight->"Bold"]}], "*", 
         SuperscriptBox[
          StyleBox[
           SubscriptBox["V", "i"],
           FontWeight->"Bold"], "T"]}]], " ", "g", " ", "Z", 
       RowBox[{"(", 
        RowBox[{
         StyleBox["I",
          FontWeight->"Bold"], " ", "-", 
         RowBox[{"2", " ", 
          StyleBox[
           SuperscriptBox[
            SubscriptBox["V", "i"], 
            StyleBox["T",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "*", 
          StyleBox[
           SubscriptBox["V", "i"],
           FontWeight->"Bold"]}]}], ")"}]}], "-", 
      RowBox[{"f", " ", 
       RowBox[{"(", 
        RowBox[{
         StyleBox["C",
          FontWeight->"Bold"], " ", "+", " ", 
         StyleBox[
          SuperscriptBox["C", 
           StyleBox["T",
            FontWeight->"Plain"]],
          FontWeight->"Bold"]}], ")"}]}]}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Z", " ", "=", " ", 
  RowBox[{
   SubscriptBox["N", "i"], "+", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"j", "\[NotEqual]", "i"}], "n"], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "d"}], " ", 
       StyleBox[
        TemplateBox[{"V","j"},
         "IndexedDefault"],
        FontWeight->"Bold"], "*", 
       StyleBox[
        TemplateBox[{"V","j"},
         "IndexedDefault"],
        FontWeight->"Bold"]}]], " ", 
     TemplateBox[{"N","j"},
      "IndexedDefault"]}]}]}]}]}], "DisplayFormula",
 CellChangeTimes->{{3.7536236359799643`*^9, 3.753623640086423*^9}, {
  3.753623699658825*^9, 3.753623719559248*^9}, {3.753623766035623*^9, 
  3.753623874356435*^9}, {3.7536239193865833`*^9, 3.7536239555687933`*^9}, {
  3.75362398593077*^9, 3.753623993594441*^9}, {3.753624084581101*^9, 
  3.7536240898100357`*^9}, {3.75362418256523*^9, 3.753624273448679*^9}, {
  3.753624308306226*^9, 3.7536243899728203`*^9}, {3.75362443845465*^9, 
  3.753624506271158*^9}},ExpressionUUID->"194a25ed-6410-4ef2-94c8-\
f5d0ded584d1"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 755},
WindowMargins->{{0, Automatic}, {Automatic, -1}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 185, 3, 146, "Title",ExpressionUUID->"c042e951-2025-4e0d-a13e-d8ca27e3d7e8"],
Cell[768, 27, 457, 14, 90, "Text",ExpressionUUID->"ae16c92a-0774-471a-8af0-3b0e4aaad753"],
Cell[CellGroupData[{
Cell[1250, 45, 263, 6, 101, "Section",ExpressionUUID->"868342de-2436-4aa4-857d-7aa946265dae"],
Cell[1516, 53, 3622, 106, 618, "Input",ExpressionUUID->"6d415337-a530-41ed-bc1c-a5d46566b929"],
Cell[CellGroupData[{
Cell[5163, 163, 205, 3, 81, "Subsection",ExpressionUUID->"53dfe3da-9e82-4d9d-89b5-12556600d176"],
Cell[CellGroupData[{
Cell[5393, 170, 2586, 55, 326, "Input",ExpressionUUID->"d7d1b27a-4531-49f2-b2d3-830f534f5dcf"],
Cell[7982, 227, 529, 11, 52, "Output",ExpressionUUID->"dda998fb-7857-4573-aaa5-d4d607747173"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8560, 244, 297, 6, 122, "Subsection",ExpressionUUID->"fe885080-7d1f-4fea-bbb3-4cb47d06127c"],
Cell[CellGroupData[{
Cell[8882, 254, 1254, 28, 140, "Input",ExpressionUUID->"3299df55-5edf-4774-8cbc-292e6791ec7e"],
Cell[10139, 284, 433, 9, 52, "Output",ExpressionUUID->"0ee4b1da-1df7-4f60-af48-9b8a4e102afa"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10633, 300, 160, 3, 101, "Section",ExpressionUUID->"6217f40e-3b58-4ee0-8b0c-953fa58c683c"],
Cell[CellGroupData[{
Cell[10818, 307, 325, 7, 122, "Subsection",ExpressionUUID->"0d85e9db-9fcb-48ea-a96a-dab77d2f3371"],
Cell[CellGroupData[{
Cell[11168, 318, 1066, 23, 78, "Input",ExpressionUUID->"699596c0-f35f-44d6-8426-255bd5dfbcf1"],
Cell[12237, 343, 1108, 27, 55, "Output",ExpressionUUID->"f78801ae-7a25-4888-9088-7ad1b5b557e9"],
Cell[13348, 372, 4488, 118, 301, "Output",ExpressionUUID->"ec2aef90-5ed1-4909-a628-5254aa0e053c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17885, 496, 250, 4, 81, "Subsection",ExpressionUUID->"60d10940-e287-44ab-b4a3-95c6295897e4"],
Cell[18138, 502, 839, 16, 226, "Text",ExpressionUUID->"b6586912-140d-4b99-9e4c-36a0e130d910"],
Cell[CellGroupData[{
Cell[19002, 522, 3273, 75, 277, "Input",ExpressionUUID->"25156734-1818-4b08-913c-3b65022a70b6"],
Cell[22278, 599, 775, 21, 52, "Output",ExpressionUUID->"3921c784-9444-4042-8f74-732ec6471bbb"],
Cell[23056, 622, 850, 22, 84, "Output",ExpressionUUID->"21eb13ca-2820-4411-8b86-1b31bdfc0187"]
}, Open  ]],
Cell[23921, 647, 231, 6, 53, "Text",ExpressionUUID->"2f1abac1-df19-44a2-8b08-f265a214a944"],
Cell[CellGroupData[{
Cell[24177, 657, 2213, 53, 233, "Input",ExpressionUUID->"390d024b-782a-439d-9347-b7e19b6e7d56"],
Cell[26393, 712, 965, 23, 510, "Output",ExpressionUUID->"e04d905f-2b34-4247-99a4-8b4f35e2ee46"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27419, 742, 172, 3, 510, "Section",ExpressionUUID->"ebcdff8f-062f-4cc4-a19e-e543db114129"],
Cell[CellGroupData[{
Cell[27616, 749, 350, 7, 616, "Subsection",ExpressionUUID->"2359ab65-b9e6-4d6d-ab67-67324da640d0"],
Cell[27969, 758, 12001, 281, 6565, "Input",ExpressionUUID->"fe626473-581a-4c4e-801e-b17e1a62e241"],
Cell[CellGroupData[{
Cell[39995, 1043, 253, 6, 337, "Subsubsection",ExpressionUUID->"1e91ab72-9bc5-428c-b2f9-244bd651dbed"],
Cell[CellGroupData[{
Cell[40273, 1053, 1000, 22, 393, "Input",ExpressionUUID->"2a83efd4-2c6b-4c46-9a52-c54117c8e28b"],
Cell[CellGroupData[{
Cell[41298, 1079, 306, 8, 182, "Print",ExpressionUUID->"53c023a8-9e58-4c15-8f0b-ff88e79d3c05"],
Cell[41607, 1089, 309, 8, 195, "Print",ExpressionUUID->"e11cc0f0-b92b-46d0-be48-67096a2bc7e8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41989, 1105, 226, 5, 409, "Subsection",ExpressionUUID->"63eb2519-1366-4790-8bc4-fefa39375bdc"],
Cell[42218, 1112, 1929, 41, 551, "Input",ExpressionUUID->"e211f600-7d52-41f2-b713-6e5c7a805505"],
Cell[44150, 1155, 239, 5, 267, "Text",ExpressionUUID->"8b7183f1-684d-4734-be9b-2d8a957fd35e"],
Cell[CellGroupData[{
Cell[44414, 1164, 1309, 20, 231, "Input",ExpressionUUID->"4c1e60b1-837f-48ec-9075-0cfdb01b0c0b"],
Cell[45726, 1186, 176, 4, 182, "Print",ExpressionUUID->"df5cb8aa-8192-405c-b17d-6661b86d8859"]
}, Open  ]],
Cell[45917, 1193, 249, 5, 267, "Text",ExpressionUUID->"bd8a66d3-4d05-4298-bcda-17b014542131"],
Cell[CellGroupData[{
Cell[46191, 1202, 2248, 47, 864, "Input",ExpressionUUID->"b3b01c37-0fa8-4b94-af89-97a800034aba"],
Cell[48442, 1251, 245, 6, 182, "Print",ExpressionUUID->"213c5985-219e-4849-bd38-45eb85625e21"]
}, Open  ]],
Cell[48702, 1260, 230, 4, 267, "Text",ExpressionUUID->"8cf098b4-7bbc-47d6-bb41-abea4e8e0747"],
Cell[CellGroupData[{
Cell[48957, 1268, 1647, 32, 231, "Input",ExpressionUUID->"a24f71fd-36a6-4df7-b694-095cdf0d2e11"],
Cell[50607, 1302, 857, 24, 333, "Print",ExpressionUUID->"04ad0e27-2439-42b6-a43e-50d89865241e"]
}, Open  ]],
Cell[51479, 1329, 229, 4, 267, "Text",ExpressionUUID->"8e9f9b9f-a4f4-4486-bc13-e44b805dac15"],
Cell[CellGroupData[{
Cell[51733, 1337, 1768, 36, 393, "Input",ExpressionUUID->"6d6aa3dc-5ca1-4ae5-af1b-97521231ef0b"],
Cell[53504, 1375, 565, 15, 182, "Print",ExpressionUUID->"9b026358-4514-4c32-ae56-faab65f99608"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[54118, 1396, 231, 5, 409, "Subsection",ExpressionUUID->"b33c9e2b-8e74-4190-bef9-ee1c47f3ff5b"],
Cell[54352, 1403, 7092, 173, 5204, "Input",ExpressionUUID->"cfb38c37-0611-4cba-9cee-b8cece2e611c"],
Cell[CellGroupData[{
Cell[61469, 1580, 6241, 176, 3847, "Input",ExpressionUUID->"a168c3a2-34ee-4fff-a7b2-3f115eda9aba"],
Cell[67713, 1758, 296, 6, 348, "Output",ExpressionUUID->"2541c3b3-1df5-4a5c-aa60-585e939136a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68046, 1769, 209, 3, 393, "Input",ExpressionUUID->"19a4609c-e92d-4a47-b488-5db34220dff1"],
Cell[68258, 1774, 1747, 33, 1163, "Output",ExpressionUUID->"40ced5f1-76a9-4afd-9181-c1ab1fd8c32f"],
Cell[70008, 1809, 1740, 32, 1163, "Output",ExpressionUUID->"27391c08-6485-4810-8cc6-ab1f7a4600bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71785, 1846, 409, 9, 393, "Input",ExpressionUUID->"0e114663-b35c-4bc8-a471-6132a7d381b5"],
Cell[72197, 1857, 431, 9, 348, "Output",ExpressionUUID->"2de0a362-ca19-4d7b-996a-283dd83d2af5"],
Cell[72631, 1868, 433, 9, 348, "Output",ExpressionUUID->"c7e48c21-faf8-4c1e-9a96-c8f80f45585c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73101, 1882, 1197, 24, 1179, "Input",ExpressionUUID->"bb74e544-090e-485b-aafe-3679224ccf75"],
Cell[CellGroupData[{
Cell[74323, 1910, 1361, 35, 627, "Print",ExpressionUUID->"28d8bb33-507d-4456-8b6b-e5c826f6dab5"],
Cell[75687, 1947, 623, 17, 182, "Print",ExpressionUUID->"e683eadd-4616-4e56-a989-c8f1810c8dc8"],
Cell[76313, 1966, 424, 12, 182, "Print",ExpressionUUID->"72d584ab-c3c8-40a0-81fe-7b6712b6795c"],
Cell[76740, 1980, 422, 12, 182, "Print",ExpressionUUID->"903ee868-88a9-47c4-a5cd-52acf6f20b00"],
Cell[77165, 1994, 422, 12, 182, "Print",ExpressionUUID->"7d3348cf-c25d-4eb8-ad12-f64eab1aa663"],
Cell[77590, 2008, 420, 12, 182, "Print",ExpressionUUID->"188755b9-34f6-46bb-a703-6624535d644a"],
Cell[78013, 2022, 443, 13, 182, "Print",ExpressionUUID->"7c45d65e-8f06-438b-b9a3-5ce56d5cfb5a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[78517, 2042, 157, 3, 409, "Subsection",ExpressionUUID->"9f79e394-880a-4937-9647-5014d93432f3"],
Cell[78677, 2047, 2517, 73, 7809, "Program",ExpressionUUID->"e7a51438-ae0e-4bc9-b9fd-6678b618ad62"],
Cell[81197, 2122, 362, 7, 535, "Subsubsection",ExpressionUUID->"f1f1733f-dee4-4371-9aa7-9f877478d1ef"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81608, 2135, 178, 3, 510, "Section",ExpressionUUID->"23196bf9-2fd6-4f94-8fd4-6a7a9e20801f"],
Cell[81789, 2140, 2627, 83, 729, "DisplayFormula",ExpressionUUID->"194a25ed-6410-4ef2-94c8-f5d0ded584d1"]
}, Open  ]]
}, Open  ]]
}
]
*)

