---
title: "Alternative stable states model"
author: "Lucas A. Nell"
date: "10/21/2018"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Alternative stable states model}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  dev = "svglite", 
  fig.width = 6,
  fig.height = 4,
  echo = FALSE
)
knitr::opts_knit$set(root.dir = normalizePath(".."))
options(tibble.print_min = 4L, tibble.print_max = 8L)
```
```{r source_Rprofile, echo = FALSE}
if (!isTRUE(getOption('knitr.in.progress'))) source(".Rprofile")
suppressPackageStartupMessages(library(tidyverse))
```



## Note on notation

Below, $*$ is vector multiplication
and
${}^t$ represents transpose.


## Model


Fitness for clone $i$ ($i \in \{1, \ldots, n\}$) at time $t$ ($F_{it}$) is as follows:

$$
\begin{align}
    F_{i} &= \exp \left\{ r(V_i) - \alpha_{ii} N_i - \sum_{j \ne i}^{n}{\alpha_{ij} N_j}  \right\}\\
    r(V_i) &= r_0 - f ~ V_i * C * (V_i)^t \\
    \alpha_{ii} &= g ~\exp \left\{- \left[ V_i * (V_i)^t \right] \right\} \\
    \alpha_{ij} &= g ~\exp \left\{- \left[ V_i * (V_i)^t + d ~ V_j * (V_j)^t \right] \right\} \\
    C &=
        \begin{pmatrix}
            1       & \eta  \\
            \eta    & 1     \\
        \end{pmatrix} \\
\end{align}
$$

where
$V$ is an $n \times 2$ matrix of trait values for all $n$ clones,
$V_i$ refers to the $i$th row in $V$,
$N$ is a $1 \times n$ vector of population abundances for all lines,
$r_0$ is the baseline growth rate,
$f$ is the cost of the trait on the growth rate,
$g$ is the benefit of the trait on density dependence,
$d$ changes how the focal line is affected by other lines' trait values,
and
$\eta$ is the non-additive effects of traits on $r$.


