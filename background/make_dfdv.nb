(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     40793,       1060]
NotebookOptionsPosition[     36453,        969]
NotebookOutlinePosition[     36890,        988]
CellTagsIndexPosition[     36847,        985]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Figuring out \[PartialD]F/\[PartialD]Vi", "Title",
 CellChangeTimes->{{3.752263784935858*^9, 3.752263822007979*^9}, {
   3.752267537617231*^9, 3.752267575007531*^9}, {3.752267668956113*^9, 
   3.752267703604451*^9}, {3.752267736295437*^9, 3.752267840325549*^9}, {
   3.752267894057188*^9, 3.7522678976456614`*^9}, 3.75226799940224*^9, {
   3.752268039363772*^9, 3.752268053780813*^9}, {3.7522681321541433`*^9, 
   3.752268150034597*^9}, {3.7522683844261103`*^9, 3.75226848378869*^9}, {
   3.75258090326116*^9, 
   3.752580910829322*^9}},ExpressionUUID->"55a67ad8-f473-418c-addd-\
a5d79740c24f"],

Cell[CellGroupData[{

Cell["\<\
Below are two scenarios of inputs, one simple the other causing problems:\
\>", "Section",
 CellChangeTimes->{{3.752580915162203*^9, 
  3.7525809463984203`*^9}},ExpressionUUID->"f4a35e53-2269-495e-9b9e-\
c5ab6cc373f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xVi", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xVnei", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xNi", "=", "10"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xNnei", "=", 
   RowBox[{"{", 
    RowBox[{"20", ",", "30", ",", "10"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xf", "=", "0.2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xg", "=", "0.1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xCC", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0.1", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "1", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.1", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xr0", "=", "0.25"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xd", "=", "0.1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zVi", "=", 
   RowBox[{"{", 
    RowBox[{
    "3.23531713336706", ",", "1.02777096442878", ",", "0.2787772170268"}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zVnei", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "5.27526782592759", ",", "1.44656382501125", ",", "0.14410174684599"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "9.97409204719588", ",", "1.06037032557651", ",", "2.78145811287686"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "5.59907909948379", ",", "2.24725058535114", ",", "1.8701455486007"}], 
      "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zNi", "=", "9.4145709397"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zNnei", "=", 
   RowBox[{"{", 
    RowBox[{
    "7.34398103217961", ",", "19.0046921810612", ",", "10.0717215593192"}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zf", "=", "0.2484041452"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zg", "=", "0.1476385485"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zCC", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "0.0450021495231871"}], ",", 
       RowBox[{"-", "0.0450021495231871"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.0450021495231871"}], ",", "1", ",", 
       RowBox[{"-", "0.0450021495231871"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.0450021495231871"}], ",", 
       RowBox[{"-", "0.0450021495231871"}], ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"zr0", "=", "0.4257492712"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zd", "=", 
   RowBox[{"-", "0.0917747103"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.751804177209345*^9, 3.7518042209205*^9}, {
   3.751804483131497*^9, 3.7518044949530077`*^9}, {3.752258214589542*^9, 
   3.752258232540894*^9}, {3.752259459472953*^9, 3.7522594612148743`*^9}, {
   3.752261002996171*^9, 3.75226101728356*^9}, 3.7522611770480223`*^9, {
   3.752518496617779*^9, 3.7525185396867847`*^9}, {3.752518630249794*^9, 
   3.752518654908496*^9}, {3.752520830825007*^9, 3.75252083477454*^9}, {
   3.752521164381974*^9, 3.7525211678333073`*^9}, 3.752521205364669*^9, {
   3.752521332255311*^9, 3.7525213396139717`*^9}, 3.752521432551298*^9, {
   3.7525215414990063`*^9, 3.752521550996459*^9}, {3.75252717986839*^9, 
   3.752527190947658*^9}, 3.752530181247246*^9, 3.7525302173442802`*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"259a86ed-6d86-439e-8b85-e63f98331a04"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Function for F, calculated for both scenarios:", "Section",
 CellChangeTimes->{{3.752580967128804*^9, 
  3.752580995207658*^9}},ExpressionUUID->"36b8306c-295d-484a-9ad6-\
83ae5a83d633"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fitness", "[", 
   RowBox[{
   "Vi_", ",", "Vnei_", ",", "Ni_", ",", "Nnei_", ",", "f_", ",", "g_", ",", 
    "CC_", ",", "r0_", ",", "d_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Exp", "[", 
   RowBox[{"r0", " ", "-", " ", 
    RowBox[{"f", " ", "*", " ", 
     RowBox[{"Vi", ".", "CC", ".", "Vi"}]}], " ", "-", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"g", " ", "*", " ", "Ni", " ", "*", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"-", " ", 
       RowBox[{"Vi", ".", "Vi"}]}], "]"}]}], "-", " ", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"g", " ", "*", " ", 
       RowBox[{"Nnei", "[", 
        RowBox[{"[", "j", "]"}], "]"}], " ", "*", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", " ", 
          RowBox[{"Vi", ".", "Vi"}]}], " ", "-", " ", 
         RowBox[{"d", " ", "*", " ", 
          RowBox[{
           RowBox[{"Vnei", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ".", 
           RowBox[{"Vnei", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"{", 
       RowBox[{"j", ",", " ", 
        RowBox[{"Length", "[", "Vnei", "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "\t", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fitness", "[", 
  RowBox[{
  "xVi", ",", "xVnei", ",", "xNi", ",", "xNnei", ",", "xf", ",", "xg", ",", 
   "xCC", ",", "xr0", ",", "xd"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"fitness", "[", 
  RowBox[{
  "zVi", ",", "zVnei", ",", "zNi", ",", "zNnei", ",", "zf", ",", "zg", ",", 
   "zCC", ",", "zr0", ",", "zd"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7518004124587917`*^9, 3.751800492695055*^9}, {
   3.751800960095036*^9, 3.751800960547876*^9}, 3.751804473665945*^9, {
   3.751804630623612*^9, 3.751804664306196*^9}, {3.7518047200249*^9, 
   3.751804730942521*^9}, {3.751804814680378*^9, 3.7518048789417763`*^9}, {
   3.751805004312256*^9, 3.751805019942697*^9}, {3.7518053761831427`*^9, 
   3.7518053848228073`*^9}, {3.752256458370504*^9, 3.752256459514567*^9}, {
   3.752256748679214*^9, 3.7522568476634808`*^9}, {3.752258311817287*^9, 
   3.752258352974115*^9}, 3.7522583836009417`*^9, {3.7522584701807404`*^9, 
   3.752258476845001*^9}, 3.752258556234805*^9, 3.7522587691015387`*^9, {
   3.752259195543626*^9, 3.752259196712212*^9}, {3.752259511556044*^9, 
   3.7522595401401567`*^9}, {3.7522596026700363`*^9, 3.752259643471435*^9}, {
   3.752261020693527*^9, 3.7522610478040543`*^9}, {3.752261088997265*^9, 
   3.7522610898975286`*^9}, {3.752522451753169*^9, 3.752522479376618*^9}, {
   3.7525225119856777`*^9, 3.752522539202475*^9}, {3.7525231451504183`*^9, 
   3.752523148205101*^9}, {3.752524233143881*^9, 3.752524247423411*^9}, 
   3.7525242950924273`*^9, {3.7525243296547937`*^9, 3.752524451435945*^9}, {
   3.752524532313957*^9, 3.7525246124087963`*^9}, {3.7525247316063232`*^9, 
   3.7525247317967443`*^9}, {3.752532831984881*^9, 3.752532834688273*^9}, {
   3.7525329252126417`*^9, 3.752532974884997*^9}, {3.75253349332694*^9, 
   3.75253349356406*^9}, {3.752533695274992*^9, 3.7525336976741858`*^9}, {
   3.7525337416373262`*^9, 3.7525337464603*^9}, {3.752533789710928*^9, 
   3.7525338360316467`*^9}, {3.7525338871953163`*^9, 3.752533892344235*^9}, {
   3.75253393637961*^9, 3.7525339619375753`*^9}, 3.752580952842162*^9, {
   3.752581008784953*^9, 3.752581009026258*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"530cee04-fe58-48ab-8620-825a6a81fedb"],

Cell[BoxData["0.050287268757791694`"], "Output",
 CellChangeTimes->{{3.7525810099007397`*^9, 3.7525810246520443`*^9}},
 CellLabel->"Out[25]=",ExpressionUUID->"25e71947-3f03-4ef2-9626-cb288a2c98ea"],

Cell[BoxData["0.0555569024569478`"], "Output",
 CellChangeTimes->{{3.7525810099007397`*^9, 3.752581024665411*^9}},
 CellLabel->"Out[26]=",ExpressionUUID->"a4eb050d-bc96-499e-be70-917ab6fd3b8d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Math expression for F:", "Section",
 CellChangeTimes->{{3.7525810417877007`*^9, 
  3.752581050559938*^9}},ExpressionUUID->"e4e20444-c3d3-4022-a2c0-\
86d8247b4449"],

Cell[BoxData[
 RowBox[{"Fexpr", ":=", " ", 
  RowBox[{"Exp", "[", 
   RowBox[{"r0", " ", "-", " ", 
    RowBox[{"f", " ", "*", " ", 
     RowBox[{"Vi", ".", "CC", ".", "Vi"}]}], " ", "-", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"g", " ", "*", "  ", 
     RowBox[{"Exp", "[", 
      RowBox[{"-", " ", 
       RowBox[{"Vi", ".", "Vi"}]}], "]"}], "*", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{"Ni", " ", "+", "\[IndentingNewLine]", "\t", 
       RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Indexed", "[", 
           RowBox[{"Nnei", ",", " ", "j"}], "]"}], " ", "/", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"d", " ", "*", " ", 
            RowBox[{
             RowBox[{"Indexed", "[", 
              RowBox[{"Vnei", ",", " ", "j"}], "]"}], ".", 
             RowBox[{"Indexed", "[", 
              RowBox[{"Vnei", ",", " ", "j"}], "]"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "\t", 
        "]"}]}], "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7525312944093637`*^9, 3.752531463750347*^9}, {
  3.7525316091006536`*^9, 3.752531701128745*^9}, {3.752532074703529*^9, 
  3.7525320782294617`*^9}, {3.752532301838607*^9, 3.752532332005362*^9}, {
  3.752532478010063*^9, 3.752532552396508*^9}, {3.7525339781164494`*^9, 
  3.752534039569167*^9}, {3.752534084793275*^9, 3.7525341109877243`*^9}, {
  3.752534395199417*^9, 3.752534449261942*^9}, {3.752534501004488*^9, 
  3.752534502658346*^9}, {3.752534616036385*^9, 3.752534641150592*^9}, {
  3.7525810591223516`*^9, 3.752581066161229*^9}, {3.752584606510788*^9, 
  3.7525846227679567`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"1316f3a3-2cd0-4476-89c3-8775b6ae9538"],

Cell[CellGroupData[{

Cell["Making sure the output is accurate:", "Subsection",
 CellChangeTimes->{{3.752581073018199*^9, 
  3.752581084025094*^9}},ExpressionUUID->"e39393cc-d63f-49dd-887c-\
f78f0fc096dc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Fexpr", " ", "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Vi", "\[Rule]", "zVi"}], ",", 
    RowBox[{"Vnei", "\[Rule]", "zVnei"}], ",", 
    RowBox[{"Ni", "\[Rule]", "zNi"}], ",", 
    RowBox[{"Nnei", "\[Rule]", "zNnei"}], ",", 
    RowBox[{"f", "\[Rule]", "zf"}], ",", 
    RowBox[{"g", "\[Rule]", "zg"}], ",", 
    RowBox[{"CC", "\[Rule]", "zCC"}], ",", 
    RowBox[{"r0", "\[Rule]", "zr0"}], ",", 
    RowBox[{"d", "\[Rule]", "zd"}], ",", " ", 
    RowBox[{"n", " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"Length", "[", "zVnei", "]"}], " ", "+", " ", "1"}]}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.752581067235447*^9, 3.7525810718104067`*^9}, {
  3.7525846073752337`*^9, 3.75258462340191*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"8bc26ba6-b818-427e-85ea-9ef1172bd335"],

Cell[BoxData["0.0555569024569478`"], "Output",
 CellChangeTimes->{{3.75253463333532*^9, 3.752534642140752*^9}, {
   3.7525844079246893`*^9, 3.7525844164718637`*^9}, 3.752584638794094*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"a47f9368-669f-42f7-b358-c5559ced6559"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Showing it in mathematical form :", "Subsection",
 CellChangeTimes->{{3.752581091272493*^9, 
  3.752581102126549*^9}},ExpressionUUID->"8776219e-eed3-4ef9-b1bf-\
12e580908ab0"],

Cell[CellGroupData[{

Cell[BoxData["Fexpr"], "Input",
 CellChangeTimes->{{3.752536911699242*^9, 3.752536923436385*^9}, {
  3.752537021407962*^9, 3.752537021509674*^9}, {3.7525846080483503`*^9, 
  3.752584624007415*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"ede10198-34a7-4bbf-81c1-915aa35ae3c6"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{"r0", "-", 
   RowBox[{"f", " ", 
    RowBox[{"Vi", ".", "CC", ".", "Vi"}]}], "-", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      RowBox[{"Vi", ".", "Vi"}]}]], " ", "g", " ", 
    RowBox[{"(", 
     RowBox[{"Ni", "+", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", "j", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}]], 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "d"}], " ", 
          RowBox[{
           TemplateBox[{"Vnei","j"},
            "IndexedDefault"], ".", 
           TemplateBox[{"Vnei","j"},
            "IndexedDefault"]}]}]], " ", 
        TemplateBox[{"Nnei","j"},
         "IndexedDefault"]}]}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.7525369169495564`*^9, 3.752536923866082*^9}, 
   3.752537022249854*^9, 3.752584419177525*^9, 3.752584640315254*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"0ada6b18-bec2-4f95-b8ce-5f4fd19a26e6"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Taking partial derivative:", "Section",
 CellChangeTimes->{{3.752584378586927*^9, 
  3.752584388778219*^9}},ExpressionUUID->"5728f101-5229-452e-b52b-\
e82336264a0e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"D", "[", 
  RowBox[{"Fexpr", ",", " ", 
   RowBox[{"{", "Vi", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"Fexpr", ",", " ", 
    RowBox[{"{", "Vi", "}"}]}], "]"}], " ", "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Vi", "\[Rule]", "xVi"}], ",", 
    RowBox[{"Vnei", "\[Rule]", "xVnei"}], ",", 
    RowBox[{"Ni", "\[Rule]", "xNi"}], ",", 
    RowBox[{"Nnei", "\[Rule]", "xNnei"}], ",", 
    RowBox[{"f", "\[Rule]", "xf"}], ",", 
    RowBox[{"g", "\[Rule]", "xg"}], ",", 
    RowBox[{"CC", "\[Rule]", "xCC"}], ",", 
    RowBox[{"r0", "\[Rule]", "xr0"}], ",", 
    RowBox[{"d", "\[Rule]", "xd"}], ",", " ", 
    RowBox[{"n", " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"Length", "[", "xVnei", "]"}], " ", "+", " ", "1"}]}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAmIQfS+i7fLdL68d09Ke3AbRdg8uvgDRV5pvg+kyMdOv
IFog6iGYftbymuMekNZWdRYG0TNPrBQH0Ql2r8D08v3nNUG01eTvYHqXQvha
EK138hGYTluy7+cjkHmfmn+D6IvCviyPgXRF3QNWEC2ivP5v1NfXjvMkjoHp
zLlLhKOBtNqTu2Ca43FBKYj+2boETD9zCGgF0TVi28F086+kXhAtdjl5Eoi+
b/qkJR5In1qa3AGiFxXNngWivZ6kzwPRL2f5HATRea8zwLT7grlHEoA0wxy3
YyD6k9GPP0lAOuOFLEMyyNx/wbYpQFpEuAVMJ7/PdQbRwVN8XEG00vv9oSCa
L+sMmGZyq69KBdL212aC6aqP22fWAGkJ+91gum2D6QIQfelqzCIQnb5CfQuI
fmNnsA1EAwAbQvnO
  "],
 CellLabel->"In[46]:=",ExpressionUUID->"2ed7d473-b70e-451e-81c0-6933d7afc3e7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"r0", "-", 
     RowBox[{"f", " ", 
      RowBox[{"Vi", ".", "CC", ".", "Vi"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        RowBox[{"Vi", ".", "Vi"}]}]], " ", "g", " ", 
      RowBox[{"(", 
       RowBox[{"Ni", "+", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", "j", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}]], 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "d"}], " ", 
            RowBox[{
             TemplateBox[{"Vnei","j"},
              "IndexedDefault"], ".", 
             TemplateBox[{"Vnei","j"},
              "IndexedDefault"]}]}]], " ", 
          TemplateBox[{"Nnei","j"},
           "IndexedDefault"]}]}]}], ")"}]}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "f"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1", ".", "CC", ".", "Vi"}], "+", 
        RowBox[{"Vi", ".", "CC", ".", "1"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        RowBox[{"Vi", ".", "Vi"}]}]], " ", "g", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"1", ".", "Vi"}]}], "-", 
        RowBox[{"Vi", ".", "1"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"Ni", "+", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", "j", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}]], 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "d"}], " ", 
            RowBox[{
             TemplateBox[{"Vnei","j"},
              "IndexedDefault"], ".", 
             TemplateBox[{"Vnei","j"},
              "IndexedDefault"]}]}]], " ", 
          TemplateBox[{"Nnei","j"},
           "IndexedDefault"]}]}]}], ")"}]}]}], ")"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.752515581555093*^9, 3.752515744308897*^9, {3.752516526089675*^9, 
   3.7525165313829317`*^9}, {3.752516723370933*^9, 3.7525167448324614`*^9}, {
   3.75252484153388*^9, 3.752524867723733*^9}, 3.752525014102482*^9, 
   3.752525046853436*^9, 3.752525324346477*^9, 3.752527411747102*^9, 
   3.752530274595437*^9, 3.7525311319500093`*^9, 3.75253194721246*^9, 
   3.752534511083537*^9, 3.752534571333537*^9, 3.752534703561181*^9, 
   3.752537060367016*^9, {3.7525844020205793`*^9, 3.7525844228122272`*^9}, {
   3.752584459253603*^9, 3.752584467327469*^9}, 3.7525846432325277`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"a2df5ff9-e91a-47aa-8859-22dc82190b46"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.050287268757791694`", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3.340120149854875`*^-6"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"1", ".", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "-", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}], ".", "1"}]}], ")"}]}], 
     "-", 
     RowBox[{"0.2`", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1", ".", 
         RowBox[{"{", 
          RowBox[{"1.5`", ",", "2.4000000000000004`", ",", "3.3`"}], "}"}]}], 
        "+", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1.5`", ",", "2.4000000000000004`", ",", "3.3`"}], "}"}], 
         ".", "1"}]}], ")"}]}]}], ")"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.752515581555093*^9, 3.752515744308897*^9, {3.752516526089675*^9, 
   3.7525165313829317`*^9}, {3.752516723370933*^9, 3.7525167448324614`*^9}, {
   3.75252484153388*^9, 3.752524867723733*^9}, 3.752525014102482*^9, 
   3.752525046853436*^9, 3.752525324346477*^9, 3.752527411747102*^9, 
   3.752530274595437*^9, 3.7525311319500093`*^9, 3.75253194721246*^9, 
   3.752534511083537*^9, 3.752534571333537*^9, 3.752534703561181*^9, 
   3.752537060367016*^9, {3.7525844020205793`*^9, 3.7525844228122272`*^9}, {
   3.752584459253603*^9, 3.752584467327469*^9}, 3.752584643250292*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"73bd1dd0-0685-40bb-ba1e-6c980ea14afb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Odd that it\[CloseCurlyQuote]s not showing a simplified version. Now I\
\[CloseCurlyQuote]ll try removing the `.1` and `1.`.\
\>", "Subsubsection",
 CellChangeTimes->{{3.7525844794787407`*^9, 
  3.7525845021176977`*^9}},ExpressionUUID->"cb27009e-8e5d-4ce2-a46b-\
86bfdd3134fb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"0.050287268757791694`", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "3.340120149854875`*^-6"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "-", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ")"}]}], "-", 
    RowBox[{"0.2`", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1.5`", ",", "2.4000000000000004`", ",", "3.3`"}], "}"}], "+", 
       RowBox[{"{", 
        RowBox[{"1.5`", ",", "2.4000000000000004`", ",", "3.3`"}], "}"}]}], 
      ")"}]}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.75252507651159*^9, 3.7525251426474*^9}, {
  3.752534587430954*^9, 3.752534602529765*^9}, {3.7525346521897*^9, 
  3.75253476982248*^9}, {3.752584505260549*^9, 3.752584533343072*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"b3adc333-85ba-4a28-a84a-157839b53376"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.030172025323635703`"}], ",", 
   RowBox[{"-", "0.0482751061454014`"}], ",", 
   RowBox[{"-", "0.06637818696716707`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.752525091355438*^9, 3.75252514398146*^9, 3.752530286214283*^9, {
   3.752534666843006*^9, 3.752534692610383*^9}, {3.7525347518430777`*^9, 
   3.752534771496173*^9}, {3.75258450645811*^9, 3.752584534691712*^9}},
 CellLabel->"Out[42]=",ExpressionUUID->"56598d6a-cab6-404d-b299-9591a4e31162"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Ah, that' s much better. Let\[CloseCurlyQuote]s see that in mathematical \
form, then simplify it:\
\>", "Subsubsection",
 CellChangeTimes->{{3.7525845393482647`*^9, 3.752584557487241*^9}, {
  3.752584771533811*^9, 
  3.7525847742140303`*^9}},ExpressionUUID->"28b3a3ab-0408-40a0-a5e0-\
ebb68be2e990"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dFdViexpr", " ", ":=", " ", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"r0", "-", 
     RowBox[{"f", " ", 
      RowBox[{"Vi", ".", "CC", ".", "Vi"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        RowBox[{"Vi", ".", "Vi"}]}]], " ", "g", " ", 
      RowBox[{"(", 
       RowBox[{"Ni", "+", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", "j", 
          RowBox[{"n", "-", "1"}]], 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "d"}], " ", 
            RowBox[{
             TemplateBox[{"Vnei","j"},
              "IndexedDefault"], ".", 
             TemplateBox[{"Vnei","j"},
              "IndexedDefault"]}]}]], " ", 
          TemplateBox[{"Nnei","j"},
           "IndexedDefault"]}]}]}], ")"}]}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "f"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", ".", "Vi"}], "+", 
        RowBox[{"Vi", ".", "CC"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        RowBox[{"Vi", ".", "Vi"}]}]], " ", "g", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "Vi"}], "-", "Vi"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"Ni", "+", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", "j", 
          RowBox[{"n", "-", "1"}]], 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "d"}], " ", 
            RowBox[{
             TemplateBox[{"Vnei","j"},
              "IndexedDefault"], ".", 
             TemplateBox[{"Vnei","j"},
              "IndexedDefault"]}]}]], " ", 
          TemplateBox[{"Nnei","j"},
           "IndexedDefault"]}]}]}], ")"}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "dFdViexpr", "]"}]}], "Input",
 CellChangeTimes->{{3.752525212179042*^9, 3.752525400609007*^9}, {
  3.752527430736088*^9, 3.752527593419628*^9}, {3.7525280113914223`*^9, 
  3.752528013775323*^9}, {3.752534963197486*^9, 3.752535045384307*^9}, {
  3.752535737890593*^9, 3.752535766224964*^9}, {3.752537538142537*^9, 
  3.7525375443797913`*^9}, {3.752538888685751*^9, 3.75253894381787*^9}, {
  3.752584661909099*^9, 3.75258471307827*^9}, {3.752584745096285*^9, 
  3.752584787167391*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"4591c2b3-f98e-40c0-9982-d82de41e1cd7"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"r0", "-", 
    RowBox[{"f", " ", 
     RowBox[{"Vi", ".", "CC", ".", "Vi"}]}], "-", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       RowBox[{"Vi", ".", "Vi"}]}]], " ", "g", " ", 
     RowBox[{"(", 
      RowBox[{"Ni", "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", "j", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}]], 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "d"}], " ", 
           RowBox[{
            TemplateBox[{"Vnei","j"},
             "IndexedDefault"], ".", 
            TemplateBox[{"Vnei","j"},
             "IndexedDefault"]}]}]], " ", 
         TemplateBox[{"Nnei","j"},
          "IndexedDefault"]}]}]}], ")"}]}]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "f"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", ".", "Vi"}], "+", 
       RowBox[{"Vi", ".", "CC"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       RowBox[{"Vi", ".", "Vi"}]}]], " ", "g", " ", "Vi", " ", 
     RowBox[{"(", 
      RowBox[{"Ni", "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", "j", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}]], 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "d"}], " ", 
           RowBox[{
            TemplateBox[{"Vnei","j"},
             "IndexedDefault"], ".", 
            TemplateBox[{"Vnei","j"},
             "IndexedDefault"]}]}]], " ", 
         TemplateBox[{"Nnei","j"},
          "IndexedDefault"]}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.752525343074067*^9, 3.7525253547549257`*^9}, {
   3.752525394498763*^9, 3.752525401406505*^9}, 3.7525272008812847`*^9, 
   3.752527251681625*^9, 3.752527458565772*^9, 3.752527494666542*^9, 
   3.752528015299011*^9, 3.752530377465357*^9, 3.7525350555622997`*^9, 
   3.752535767347728*^9, 3.752537544898891*^9, {3.7525388974157476`*^9, 
   3.7525389133853197`*^9}, 3.752538944668715*^9, 3.752584757876759*^9, 
   3.7525848243481903`*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"c1128e0b-6301-4626-be39-3d81b790a1d9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Now verify that answers look good (compare these to values those below that \
use numerical derivatives) :\
\>", "Subsubsection",
 CellChangeTimes->{{3.752584794605687*^9, 3.752584817287219*^9}, {
  3.752584963259652*^9, 3.752584966067472*^9}, {3.752585048583922*^9, 
  3.7525850494077377`*^9}},ExpressionUUID->"44a5a94c-76f9-4c48-a46a-\
d467ff281816"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dFdViexpr", " ", "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Vi", "\[Rule]", "xVi"}], ",", 
    RowBox[{"Vnei", "\[Rule]", "xVnei"}], ",", 
    RowBox[{"Ni", "\[Rule]", "xNi"}], ",", 
    RowBox[{"Nnei", "\[Rule]", "xNnei"}], ",", 
    RowBox[{"f", "\[Rule]", "xf"}], ",", 
    RowBox[{"g", "\[Rule]", "xg"}], ",", 
    RowBox[{"CC", "\[Rule]", "xCC"}], ",", 
    RowBox[{"r0", "\[Rule]", "xr0"}], ",", 
    RowBox[{"d", "\[Rule]", "xd"}], ",", " ", 
    RowBox[{"n", " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"Length", "[", "xVnei", "]"}], " ", "+", " ", "1"}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"dFdViexpr", "  ", "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Vi", "\[Rule]", "zVi"}], ",", 
    RowBox[{"Vnei", "\[Rule]", "zVnei"}], ",", 
    RowBox[{"Ni", "\[Rule]", "zNi"}], ",", 
    RowBox[{"Nnei", "\[Rule]", "zNnei"}], ",", 
    RowBox[{"f", "\[Rule]", "zf"}], ",", 
    RowBox[{"g", "\[Rule]", "zg"}], ",", 
    RowBox[{"CC", "\[Rule]", "zCC"}], ",", 
    RowBox[{"r0", "\[Rule]", "zr0"}], ",", 
    RowBox[{"d", "\[Rule]", "zd"}], ",", " ", 
    RowBox[{"n", " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"Length", "[", "zVnei", "]"}], " ", "+", " ", "1"}]}]}], 
   "}"}]}]}], "Input",
 CellLabel->"In[55]:=",ExpressionUUID->"76630ed8-1453-4803-9f1e-6b4045f87bc3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.030172025323635703`"}], ",", 
   RowBox[{"-", "0.0482751061454014`"}], ",", 
   RowBox[{"-", "0.06637818696716707`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.752525343074067*^9, 3.7525253547549257`*^9}, {
   3.752525394498763*^9, 3.752525401406505*^9}, 3.7525272008812847`*^9, 
   3.752527251681625*^9, 3.752527458565772*^9, 3.752527494666542*^9, 
   3.752528015299011*^9, 3.752530377465357*^9, 3.7525350555622997`*^9, 
   3.752535767347728*^9, 3.752537544898891*^9, {3.7525388974157476`*^9, 
   3.7525389133853197`*^9}, 3.752538944668715*^9, 3.752584757894311*^9, {
   3.752584791298267*^9, 3.752584820121018*^9}},
 CellLabel->"Out[55]=",ExpressionUUID->"f6cf5c22-2200-49ca-899f-32ab6f196a35"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.10472157935609634`", ",", "0.03711650479336707`", ",", 
   "0.014178919680715852`"}], "}"}]], "Output",
 CellChangeTimes->{{3.752525343074067*^9, 3.7525253547549257`*^9}, {
   3.752525394498763*^9, 3.752525401406505*^9}, 3.7525272008812847`*^9, 
   3.752527251681625*^9, 3.752527458565772*^9, 3.752527494666542*^9, 
   3.752528015299011*^9, 3.752530377465357*^9, 3.7525350555622997`*^9, 
   3.752535767347728*^9, 3.752537544898891*^9, {3.7525388974157476`*^9, 
   3.7525389133853197`*^9}, 3.752538944668715*^9, 3.752584757894311*^9, {
   3.752584791298267*^9, 3.7525848201340933`*^9}},
 CellLabel->"Out[56]=",ExpressionUUID->"4660ba4a-6635-4e38-82d8-0c9bfc4275b5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical derivatives:", "Section",
 CellChangeTimes->{{3.752584973139201*^9, 3.752585003260762*^9}, {
  3.75258503767762*^9, 
  3.752585055174326*^9}},ExpressionUUID->"96a5f154-4fdc-4324-b274-\
9fdf24e4cce1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<NumericalCalculus`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ND", "[", 
    RowBox[{
     RowBox[{"fitness", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", " ", 
         RowBox[{"xVi", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
         RowBox[{"xVi", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "xVnei", ",", "xNi", 
       ",", "xNnei", ",", "xf", ",", "xg", ",", "xCC", ",", "xr0", ",", 
       "xd"}], "]"}], ",", " ", "x", ",", " ", 
     RowBox[{"xVi", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ND", "[", 
    RowBox[{
     RowBox[{"fitness", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xVi", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "x", ",", " ", 
         RowBox[{"xVi", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "xVnei", ",", "xNi", 
       ",", "xNnei", ",", "xf", ",", "xg", ",", "xCC", ",", "xr0", ",", 
       "xd"}], "]"}], ",", " ", "x", ",", " ", 
     RowBox[{"xVi", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ND", "[", 
    RowBox[{
     RowBox[{"fitness", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xVi", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{"xVi", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", "x"}], "}"}], ",", 
       "xVnei", ",", "xNi", ",", "xNnei", ",", "xf", ",", "xg", ",", "xCC", 
       ",", "xr0", ",", "xd"}], "]"}], ",", " ", "x", ",", " ", 
     RowBox[{"xVi", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.752516958497101*^9, 3.752517021524077*^9}, {
  3.7525170587911386`*^9, 3.752517067157928*^9}, {3.752517305631619*^9, 
  3.7525173483221693`*^9}, {3.752517429447177*^9, 3.7525174325168962`*^9}, {
  3.752517793865541*^9, 3.752517816249836*^9}, {3.752517847292676*^9, 
  3.752517852218338*^9}, {3.752517888963311*^9, 3.752517906323388*^9}, {
  3.752517959262383*^9, 3.752517959878326*^9}, {3.752518189612853*^9, 
  3.7525182358526793`*^9}, {3.752518310092636*^9, 3.752518316369891*^9}, {
  3.752518361123601*^9, 3.752518377332144*^9}, {3.752584889894198*^9, 
  3.752584907180266*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"69aa3d58-7d27-4b00-b457-4eb4d69455e8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.030172025325501017`"}], ",", 
   RowBox[{"-", "0.04827510614522046`"}], ",", 
   RowBox[{"-", "0.0663781869641073`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.752517008689887*^9, 3.752517023399184*^9}, 
   3.752517069989655*^9, 3.752517306944764*^9, 3.752517349135127*^9, 
   3.752517433434786*^9, 3.752517473836632*^9, 3.752517818235105*^9, {
   3.752517884448964*^9, 3.7525179067810793`*^9}, 3.7525179606925297`*^9, {
   3.752518194159678*^9, 3.7525182365768347`*^9}, 3.752518378476025*^9, 
   3.752528735800022*^9, 3.752530764087862*^9, 3.7525848775486183`*^9, 
   3.75258491191711*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"bba145c2-6eaf-4ade-badb-97aa4889c843"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ND", "[", 
    RowBox[{
     RowBox[{"fitness", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z", ",", " ", 
         RowBox[{"zVi", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
         RowBox[{"zVi", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "zVnei", ",", "zNi", 
       ",", "zNnei", ",", "zf", ",", "zg", ",", "zCC", ",", "zr0", ",", 
       "zd"}], "]"}], ",", " ", "z", ",", " ", 
     RowBox[{"zVi", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ND", "[", 
    RowBox[{
     RowBox[{"fitness", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"zVi", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "z", ",", " ", 
         RowBox[{"zVi", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "zVnei", ",", "zNi", 
       ",", "zNnei", ",", "zf", ",", "zg", ",", "zCC", ",", "zr0", ",", 
       "zd"}], "]"}], ",", " ", "z", ",", " ", 
     RowBox[{"zVi", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ND", "[", 
    RowBox[{
     RowBox[{"fitness", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"zVi", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{"zVi", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", "z"}], "}"}], ",", 
       "zVnei", ",", "zNi", ",", "zNnei", ",", "zf", ",", "zg", ",", "zCC", 
       ",", "zr0", ",", "zd"}], "]"}], ",", " ", "z", ",", " ", 
     RowBox[{"zVi", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.752528745626951*^9, 3.752528757071782*^9}, {
  3.7525287999255447`*^9, 3.752528810051428*^9}, {3.752530782333228*^9, 
  3.7525308352369537`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"a357db55-7c9a-4d5f-b738-d1cd79c631d5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.10472102023966319`", ",", "0.03711651209914585`", ",", 
   "0.014178918366732912`"}], "}"}]], "Output",
 CellChangeTimes->{{3.752530766307499*^9, 3.752530783185656*^9}, 
   3.752530836144499*^9, 3.752584881101088*^9, 3.7525849138018217`*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"fca4efb3-f2bd-4013-81ac-19451ce72262"]
}, Open  ]]
}, Open  ]],

Cell["Yay, they' re the same! Success.", "Section",
 CellChangeTimes->{{3.752585060448298*^9, 
  3.752585073734779*^9}},ExpressionUUID->"153a4e4d-06df-4ec8-9dd9-\
1461f810f654"]
}, Open  ]]
},
WindowSize->{1280, 755},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 600, 9, 146, "Title",ExpressionUUID->"55a67ad8-f473-418c-addd-a5d79740c24f"],
Cell[CellGroupData[{
Cell[1205, 35, 228, 5, 158, "Section",ExpressionUUID->"f4a35e53-2269-495e-9b9e-c5ab6cc373f5"],
Cell[1436, 42, 3774, 109, 729, "Input",ExpressionUUID->"259a86ed-6d86-439e-8b85-e63f98331a04"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5247, 156, 191, 3, 101, "Section",ExpressionUUID->"36b8306c-295d-484a-9ad6-83ae5a83d633"],
Cell[CellGroupData[{
Cell[5463, 163, 3561, 69, 295, "Input",ExpressionUUID->"530cee04-fe58-48ab-8620-825a6a81fedb"],
Cell[9027, 234, 197, 2, 52, "Output",ExpressionUUID->"25e71947-3f03-4ef2-9626-cb288a2c98ea"],
Cell[9227, 238, 193, 2, 52, "Output",ExpressionUUID->"a4eb050d-bc96-499e-be70-917ab6fd3b8d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9469, 246, 169, 3, 101, "Section",ExpressionUUID->"e4e20444-c3d3-4022-a2c0-86d8247b4449"],
Cell[9641, 251, 1916, 40, 295, "Input",ExpressionUUID->"1316f3a3-2cd0-4476-89c3-8775b6ae9538"],
Cell[CellGroupData[{
Cell[11582, 295, 183, 3, 81, "Subsection",ExpressionUUID->"e39393cc-d63f-49dd-887c-f78f0fc096dc"],
Cell[CellGroupData[{
Cell[11790, 302, 823, 19, 78, "Input",ExpressionUUID->"8bc26ba6-b818-427e-85ea-9ef1172bd335"],
Cell[12616, 323, 266, 3, 52, "Output",ExpressionUUID->"a47f9368-669f-42f7-b358-c5559ced6559"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12931, 332, 181, 3, 81, "Subsection",ExpressionUUID->"8776219e-eed3-4ef9-b1bf-12e580908ab0"],
Cell[CellGroupData[{
Cell[13137, 339, 276, 4, 46, "Input",ExpressionUUID->"ede10198-34a7-4bbf-81c1-915aa35ae3c6"],
Cell[13416, 345, 1018, 28, 67, "Output",ExpressionUUID->"0ada6b18-bec2-4f95-b8ce-5f4fd19a26e6"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14495, 380, 171, 3, 101, "Section",ExpressionUUID->"5728f101-5229-452e-b52b-e82336264a0e"],
Cell[CellGroupData[{
Cell[14691, 387, 1389, 33, 109, "Input",ExpressionUUID->"2ed7d473-b70e-451e-81c0-6933d7afc3e7"],
Cell[16083, 422, 2640, 71, 155, "Output",ExpressionUUID->"a2df5ff9-e91a-47aa-8859-22dc82190b46"],
Cell[18726, 495, 1526, 37, 55, "Output",ExpressionUUID->"73bd1dd0-0685-40bb-ba1e-6c980ea14afb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20289, 537, 287, 6, 67, "Subsubsection",ExpressionUUID->"cb27009e-8e5d-4ce2-a46b-86bfdd3134fb"],
Cell[CellGroupData[{
Cell[20601, 547, 948, 24, 109, "Input",ExpressionUUID->"b3adc333-85ba-4a28-a84a-157839b53376"],
Cell[21552, 573, 511, 10, 52, "Output",ExpressionUUID->"56598d6a-cab6-404d-b299-9591a4e31162"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22112, 589, 310, 7, 67, "Subsubsection",ExpressionUUID->"28b3a3ab-0408-40a0-a5e0-ebb68be2e990"],
Cell[CellGroupData[{
Cell[22447, 600, 2457, 67, 179, "Input",ExpressionUUID->"4591c2b3-f98e-40c0-9982-d82de41e1cd7"],
Cell[24907, 669, 2273, 63, 94, "Output",ExpressionUUID->"c1128e0b-6301-4626-be39-3d81b790a1d9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27229, 738, 362, 7, 106, "Subsubsection",ExpressionUUID->"44a5a94c-76f9-4c48-a46a-d467ff281816"],
Cell[CellGroupData[{
Cell[27616, 749, 1343, 33, 140, "Input",ExpressionUUID->"76630ed8-1453-4803-9f1e-6b4045f87bc3"],
Cell[28962, 784, 756, 13, 52, "Output",ExpressionUUID->"f6cf5c22-2200-49ca-899f-32ab6f196a35"],
Cell[29721, 799, 709, 12, 52, "Output",ExpressionUUID->"4660ba4a-6635-4e38-82d8-0c9bfc4275b5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30491, 818, 215, 4, 101, "Section",ExpressionUUID->"96a5f154-4fdc-4324-b274-9fdf24e4cce1"],
Cell[CellGroupData[{
Cell[30731, 826, 2445, 56, 140, "Input",ExpressionUUID->"69aa3d58-7d27-4b00-b457-4eb4d69455e8"],
Cell[33179, 884, 729, 13, 52, "Output",ExpressionUUID->"bba145c2-6eaf-4ade-badb-97aa4889c843"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33945, 902, 1920, 48, 109, "Input",ExpressionUUID->"a357db55-7c9a-4d5f-b738-d1cd79c631d5"],
Cell[35868, 952, 365, 7, 52, "Output",ExpressionUUID->"fca4efb3-f2bd-4013-81ac-19451ce72262"]
}, Open  ]]
}, Open  ]],
Cell[36260, 963, 177, 3, 101, "Section",ExpressionUUID->"153a4e4d-06df-4ec8-9dd9-1461f810f654"]
}, Open  ]]
}
]
*)

